<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring AI ë¬¸ì œ í•´ê²° ê°€ì´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .code-block { background: #2d3748; border-radius: 8px; }
        .copy-button { transition: all 0.2s ease; }
        .copy-button:hover { background-color: #4a5568; }
        .problem-card { transition: all 0.3s ease; }
        .problem-card:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <a href="../index.html" class="flex items-center text-xl font-bold text-gray-800">
                        <i class="fab fa-spring text-green-600 mr-2"></i>
                        Spring AI Hub
                    </a>
                    <span class="mx-3 text-gray-400">/</span>
                    <span class="text-gray-600">ë¬¸ì œ í•´ê²° ê°€ì´ë“œ</span>
                </div>
                <a href="../index.html" class="text-blue-600 hover:text-blue-800">
                    <i class="fas fa-home"></i> í™ˆìœ¼ë¡œ
                </a>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl font-bold mb-4">ğŸ”§ Spring AI ë¬¸ì œ í•´ê²° ê°€ì´ë“œ</h1>
            <p class="text-gray-600 mb-8">ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²° ë°©ë²•, ë””ë²„ê¹… ê¸°ë²•</p>

            <!-- Table of Contents -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">ëª©ì°¨</h2>
                <ul class="space-y-2 text-blue-600">
                    <li><a href="#common-errors" class="hover:underline">1. ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì™€ í•´ê²°ë²•</a></li>
                    <li><a href="#api-issues" class="hover:underline">2. API ê´€ë ¨ ë¬¸ì œ</a></li>
                    <li><a href="#performance-issues" class="hover:underline">3. ì„±ëŠ¥ ë¬¸ì œ</a></li>
                    <li><a href="#memory-issues" class="hover:underline">4. ë©”ëª¨ë¦¬ ë¬¸ì œ</a></li>
                    <li><a href="#vectorstore-issues" class="hover:underline">5. ë²¡í„° ìŠ¤í† ì–´ ë¬¸ì œ</a></li>
                    <li><a href="#debugging-techniques" class="hover:underline">6. ë””ë²„ê¹… ê¸°ë²•</a></li>
                    <li><a href="#production-issues" class="hover:underline">7. í”„ë¡œë•ì…˜ ë¬¸ì œ</a></li>
                    <li><a href="#troubleshooting-tools" class="hover:underline">8. ë¬¸ì œ í•´ê²° ë„êµ¬</a></li>
                </ul>
            </div>

            <!-- Section 1: Common Errors -->
            <section id="common-errors" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">1. ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì™€ í•´ê²°ë²•</h2>
                
                <!-- Rate Limit Error -->
                <div class="problem-card bg-white rounded-lg shadow-sm p-6 mb-6">
                    <div class="flex items-center mb-3">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl mr-3"></i>
                        <h3 class="text-lg font-semibold">Rate Limit ì´ˆê³¼ ì˜¤ë¥˜</h3>
                    </div>
                    
                    <div class="bg-red-50 p-3 rounded mb-4">
                        <p class="text-sm font-mono">
                            RateLimitException: Rate limit reached for requests-per-minute (RPM): Limit 60
                        </p>
                    </div>
                    
                    <h4 class="font-semibold mb-2">í•´ê²° ë°©ë²•:</h4>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('rate-limit-solution')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="rate-limit-solution"><code class="language-java">@Configuration
public class RateLimitConfig {
    
    @Bean
    public RateLimiter rateLimiter() {
        return RateLimiter.create(50.0); // ì´ˆë‹¹ 50ê°œ ìš”ì²­
    }
    
    @Bean
    public RetryTemplate retryTemplate() {
        RetryTemplate template = new RetryTemplate();
        
        // ì§€ìˆ˜ ë°±ì˜¤í”„ ì „ëµ
        ExponentialBackOffPolicy backOffPolicy = new ExponentialBackOffPolicy();
        backOffPolicy.setInitialInterval(1000);
        backOffPolicy.setMultiplier(2);
        backOffPolicy.setMaxInterval(60000);
        
        template.setBackOffPolicy(backOffPolicy);
        
        // ì¬ì‹œë„ ì •ì±…
        SimpleRetryPolicy retryPolicy = new SimpleRetryPolicy();
        retryPolicy.setMaxAttempts(5);
        template.setRetryPolicy(retryPolicy);
        
        return template;
    }
}

@Service
public class RateLimitedAIService {
    
    private final ChatClient chatClient;
    private final RateLimiter rateLimiter;
    private final RetryTemplate retryTemplate;
    
    public String callWithRateLimit(String prompt) {
        return retryTemplate.execute(context -> {
            // Rate limiting
            rateLimiter.acquire();
            
            try {
                return chatClient.prompt()
                    .user(prompt)
                    .call()
                    .content();
            } catch (RateLimitException e) {
                log.warn("Rate limit hit, attempt {}", context.getRetryCount());
                throw e;
            }
        });
    }
}</code></pre>
                    </div>
                    
                    <div class="bg-blue-50 p-3 rounded">
                        <p class="text-sm">
                            <strong>ì¶”ê°€ íŒ:</strong> ì—¬ëŸ¬ API í‚¤ë¥¼ ë¡œí…Œì´ì…˜í•˜ê±°ë‚˜, ìš”ì²­ì„ ë°°ì¹˜ë¡œ ì²˜ë¦¬í•˜ì—¬ 
                            Rate Limitì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.
                        </p>
                    </div>
                </div>

                <!-- Token Limit Error -->
                <div class="problem-card bg-white rounded-lg shadow-sm p-6 mb-6">
                    <div class="flex items-center mb-3">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl mr-3"></i>
                        <h3 class="text-lg font-semibold">í† í° ì œí•œ ì´ˆê³¼</h3>
                    </div>
                    
                    <div class="bg-red-50 p-3 rounded mb-4">
                        <p class="text-sm font-mono">
                            InvalidRequestError: This model's maximum context length is 4096 tokens
                        </p>
                    </div>
                    
                    <h4 class="font-semibold mb-2">í•´ê²° ë°©ë²•:</h4>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('token-limit-solution')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="token-limit-solution"><code class="language-java">@Service
public class TokenManagementService {
    
    private final TokenCounter tokenCounter;
    private static final int MAX_TOKENS = 4096;
    private static final int RESPONSE_BUFFER = 1000;
    
    public String processLongText(String text) {
        int tokenCount = tokenCounter.count(text);
        
        if (tokenCount > MAX_TOKENS - RESPONSE_BUFFER) {
            // ì˜µì…˜ 1: í…ìŠ¤íŠ¸ ë¶„í• 
            return processInChunks(text);
            
            // ì˜µì…˜ 2: í…ìŠ¤íŠ¸ ìš”ì•½
            // return summarizeAndProcess(text);
            
            // ì˜µì…˜ 3: ëª¨ë¸ ë³€ê²½
            // return processWithLargerModel(text);
        }
        
        return processNormally(text);
    }
    
    private String processInChunks(String text) {
        List<String> chunks = splitIntoChunks(text, MAX_TOKENS - RESPONSE_BUFFER);
        StringBuilder result = new StringBuilder();
        
        for (String chunk : chunks) {
            String response = chatClient.prompt()
                .system("ì´ì „ ë‚´ìš©ì„ ì´ì–´ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤.")
                .user(chunk)
                .call()
                .content();
            
            result.append(response).append("\n");
        }
        
        return result.toString();
    }
    
    // ìŠ¤ë§ˆíŠ¸ ì²­í‚¹ - ë¬¸ì¥ ê²½ê³„ ìœ ì§€
    private List<String> splitIntoChunks(String text, int maxTokensPerChunk) {
        List<String> chunks = new ArrayList<>();
        String[] sentences = text.split("(?<=[.!?])\\s+");
        
        StringBuilder currentChunk = new StringBuilder();
        int currentTokens = 0;
        
        for (String sentence : sentences) {
            int sentenceTokens = tokenCounter.count(sentence);
            
            if (currentTokens + sentenceTokens > maxTokensPerChunk) {
                chunks.add(currentChunk.toString());
                currentChunk = new StringBuilder();
                currentTokens = 0;
            }
            
            currentChunk.append(sentence).append(" ");
            currentTokens += sentenceTokens;
        }
        
        if (currentChunk.length() > 0) {
            chunks.add(currentChunk.toString());
        }
        
        return chunks;
    }
}</code></pre>
                    </div>
                </div>

                <!-- Connection Timeout -->
                <div class="problem-card bg-white rounded-lg shadow-sm p-6 mb-6">
                    <div class="flex items-center mb-3">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl mr-3"></i>
                        <h3 class="text-lg font-semibold">ì—°ê²° íƒ€ì„ì•„ì›ƒ</h3>
                    </div>
                    
                    <div class="bg-red-50 p-3 rounded mb-4">
                        <p class="text-sm font-mono">
                            SocketTimeoutException: Read timed out
                        </p>
                    </div>
                    
                    <h4 class="font-semibold mb-2">í•´ê²° ë°©ë²•:</h4>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('timeout-solution')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="timeout-solution"><code class="language-java">@Configuration
public class TimeoutConfiguration {
    
    @Bean
    public RestClient restClient() {
        return RestClient.builder()
            .requestFactory(createRequestFactory())
            .build();
    }
    
    private ClientHttpRequestFactory createRequestFactory() {
        SimpleClientHttpRequestFactory factory = new SimpleClientHttpRequestFactory();
        factory.setConnectTimeout(10000);  // ì—°ê²° íƒ€ì„ì•„ì›ƒ: 10ì´ˆ
        factory.setReadTimeout(60000);     // ì½ê¸° íƒ€ì„ì•„ì›ƒ: 60ì´ˆ
        return factory;
    }
    
    // WebClient ì„¤ì •
    @Bean
    public WebClient webClient() {
        HttpClient httpClient = HttpClient.create()
            .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 10000)
            .doOnConnected(conn -> 
                conn.addHandlerLast(new ReadTimeoutHandler(60))
                    .addHandlerLast(new WriteTimeoutHandler(60)));
        
        return WebClient.builder()
            .clientConnector(new ReactorClientHttpConnector(httpClient))
            .build();
    }
}

// íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
@Service
public class TimeoutHandlingService {
    
    public String callWithTimeout(String prompt, Duration timeout) {
        try {
            return CompletableFuture
                .supplyAsync(() -> chatClient.prompt()
                    .user(prompt)
                    .call()
                    .content())
                .get(timeout.toMillis(), TimeUnit.MILLISECONDS);
                
        } catch (TimeoutException e) {
            log.error("Request timed out after {}", timeout);
            // í´ë°± ì²˜ë¦¬
            return handleTimeout(prompt);
        }
    }
    
    private String handleTimeout(String prompt) {
        // ì˜µì…˜ 1: ë” ë¹ ë¥¸ ëª¨ë¸ë¡œ ì¬ì‹œë„
        // ì˜µì…˜ 2: ìºì‹œëœ ì‘ë‹µ ë°˜í™˜
        // ì˜µì…˜ 3: ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜
        return "ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 2: API Issues -->
            <section id="api-issues" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">2. API ê´€ë ¨ ë¬¸ì œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">API í‚¤ ë¬¸ì œ</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('api-key-issues')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="api-key-issues"><code class="language-java">@Component
@Slf4j
public class APIKeyValidator {
    
    @PostConstruct
    public void validateAPIKeys() {
        // í™˜ê²½ ë³€ìˆ˜ í™•ì¸
        validateEnvironmentVariable("OPENAI_API_KEY");
        validateEnvironmentVariable("ANTHROPIC_API_KEY");
        
        // API í‚¤ í˜•ì‹ ê²€ì¦
        validateAPIKeyFormat();
        
        // API ì—°ê²° í…ŒìŠ¤íŠ¸
        testAPIConnection();
    }
    
    private void validateEnvironmentVariable(String varName) {
        String value = System.getenv(varName);
        if (value == null || value.trim().isEmpty()) {
            log.error("Environment variable {} is not set", varName);
            throw new ConfigurationException(
                varName + " is not configured. Please set it in your environment."
            );
        }
        
        // ë§ˆìŠ¤í‚¹ëœ ê°’ ë¡œê·¸
        log.info("{} is configured: {}...{}", 
            varName, 
            value.substring(0, 4), 
            value.substring(value.length() - 4)
        );
    }
    
    private void validateAPIKeyFormat() {
        String openaiKey = System.getenv("OPENAI_API_KEY");
        if (openaiKey != null && !openaiKey.startsWith("sk-")) {
            log.warn("OpenAI API key format seems incorrect");
        }
    }
    
    private void testAPIConnection() {
        try {
            // ê°„ë‹¨í•œ API í˜¸ì¶œë¡œ ì—°ê²° í…ŒìŠ¤íŠ¸
            String response = chatClient.prompt()
                .user("Hi")
                .call()
                .content();
            
            log.info("API connection test successful");
        } catch (Exception e) {
            log.error("API connection test failed", e);
            throw new APIConnectionException(
                "Failed to connect to AI API. Please check your API key and network connection."
            );
        }
    }
}

// API í‚¤ ë¡œí…Œì´ì…˜
@Service
public class APIKeyRotationService {
    
    private final List<String> apiKeys;
    private final AtomicInteger currentIndex = new AtomicInteger(0);
    
    public APIKeyRotationService(@Value("${api.keys}") List<String> apiKeys) {
        this.apiKeys = apiKeys;
    }
    
    public String getNextAPIKey() {
        int index = currentIndex.getAndIncrement() % apiKeys.size();
        return apiKeys.get(index);
    }
    
    public void markKeyAsInvalid(String key) {
        apiKeys.remove(key);
        if (apiKeys.isEmpty()) {
            throw new NoValidAPIKeysException("All API keys are invalid");
        }
    }
}</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold mb-3 mt-6">ì‘ë‹µ í˜•ì‹ ë¬¸ì œ</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('response-format-issues')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="response-format-issues"><code class="language-java">@Service
public class ResponseValidationService {
    
    public <T> T parseStructuredResponse(String response, Class<T> targetClass) {
        try {
            // JSON ì‘ë‹µ íŒŒì‹±
            return objectMapper.readValue(response, targetClass);
        } catch (JsonProcessingException e) {
            log.error("Failed to parse response as JSON", e);
            
            // ëŒ€ì²´ íŒŒì‹± ì‹œë„
            return tryAlternativeParsing(response, targetClass);
        }
    }
    
    private <T> T tryAlternativeParsing(String response, Class<T> targetClass) {
        // ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±°
        String cleaned = response
            .replaceAll("```json\\n", "")
            .replaceAll("```", "")
            .trim();
        
        try {
            return objectMapper.readValue(cleaned, targetClass);
        } catch (Exception e) {
            // í…ìŠ¤íŠ¸ íŒŒì‹± ì‹œë„
            return parseAsText(cleaned, targetClass);
        }
    }
    
    // êµ¬ì¡°í™”ëœ ì¶œë ¥ ê°•ì œ
    public <T> T getStructuredOutput(String prompt, Class<T> outputClass) {
        String structuredPrompt = String.format("""
            %s
            
            ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”:
            %s
            
            ì¶”ê°€ ì„¤ëª…ì´ë‚˜ ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.
            """, 
            prompt, 
            generateJsonSchema(outputClass)
        );
        
        int maxRetries = 3;
        for (int i = 0; i < maxRetries; i++) {
            try {
                String response = chatClient.prompt()
                    .user(structuredPrompt)
                    .call()
                    .content();
                
                return objectMapper.readValue(response, outputClass);
            } catch (Exception e) {
                log.warn("Attempt {} failed to get structured output", i + 1);
            }
        }
        
        throw new StructuredOutputException("Failed to get valid structured output");
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 3: Performance Issues -->
            <section id="performance-issues" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">3. ì„±ëŠ¥ ë¬¸ì œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ëŠë¦° ì‘ë‹µ ì‹œê°„</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('slow-response-fix')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="slow-response-fix"><code class="language-java">@Service
@Slf4j
public class PerformanceDiagnostics {
    
    private final MeterRegistry meterRegistry;
    
    public void diagnoseSlowResponse(String operation) {
        // 1. ë³‘ëª© ì§€ì  ì°¾ê¸°
        Timer.Sample sample = Timer.start(meterRegistry);
        
        try {
            // ê° ë‹¨ê³„ë³„ ì‹œê°„ ì¸¡ì •
            long promptTime = measurePromptPreparation();
            long apiCallTime = measureAPICall();
            long postProcessTime = measurePostProcessing();
            
            log.info("Performance breakdown - Prompt: {}ms, API: {}ms, PostProcess: {}ms",
                promptTime, apiCallTime, postProcessTime);
            
            // ë³‘ëª© ì§€ì  ì‹ë³„
            if (apiCallTime > 5000) {
                optimizeAPICall();
            } else if (promptTime > 1000) {
                optimizePromptPreparation();
            }
            
        } finally {
            sample.stop(Timer.builder("performance.diagnosis")
                .tag("operation", operation)
                .register(meterRegistry));
        }
    }
    
    private void optimizeAPICall() {
        // ëª¨ë¸ ë³€ê²½ ì œì•ˆ
        log.info("Consider using a faster model like gpt-4o-mini");
        
        // ìŠ¤íŠ¸ë¦¬ë° í™œì„±í™”
        log.info("Enable streaming for better perceived performance");
        
        // ìºì‹± í™œì„±í™”
        log.info("Enable response caching for repeated queries");
    }
    
    // í”„ë¡œíŒŒì¼ë§
    @Component
    @EnableScheduling
    public class PerformanceProfiler {
        
        private final Map<String, OperationStats> operationStats = new ConcurrentHashMap<>();
        
        @Around("@annotation(Profiled)")
        public Object profile(ProceedingJoinPoint pjp) throws Throwable {
            String operation = pjp.getSignature().toShortString();
            long startTime = System.currentTimeMillis();
            
            try {
                Object result = pjp.proceed();
                recordSuccess(operation, System.currentTimeMillis() - startTime);
                return result;
            } catch (Exception e) {
                recordFailure(operation, System.currentTimeMillis() - startTime);
                throw e;
            }
        }
        
        @Scheduled(fixedRate = 60000) // 1ë¶„ë§ˆë‹¤
        public void reportStats() {
            operationStats.forEach((operation, stats) -> {
                if (stats.getAverageTime() > 1000) {
                    log.warn("Slow operation detected: {} avg={}ms",
                        operation, stats.getAverageTime());
                }
            });
        }
    }
}</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold mb-3 mt-6">ë†’ì€ ì§€ì—° ì‹œê°„</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('high-latency-fix')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="high-latency-fix"><code class="language-java">@Service
public class LatencyOptimizer {
    
    // ì§€ì—° ì‹œê°„ ìµœì†Œí™” ì „ëµ
    public CompletableFuture<String> optimizedCall(String prompt) {
        // 1. ë³‘ë ¬ ìš”ì²­ (ë‹¤ì¤‘ ëª¨ë¸)
        CompletableFuture<String> primary = callPrimaryModel(prompt);
        CompletableFuture<String> fallback = callFallbackModel(prompt);
        
        // ë¨¼ì € ì™„ë£Œë˜ëŠ” ê²ƒ ì‚¬ìš©
        return CompletableFuture.anyOf(primary, fallback)
            .thenApply(result -> (String) result);
    }
    
    // 2. ì—°ê²° ì¬ì‚¬ìš©
    @Bean
    public ConnectionProvider connectionProvider() {
        return ConnectionProvider.builder("custom")
            .maxConnections(100)
            .pendingAcquireMaxCount(500)
            .pendingAcquireTimeout(Duration.ofSeconds(45))
            .maxIdleTime(Duration.ofSeconds(20))
            .build();
    }
    
    // 3. ì§€ë¦¬ì  ë¼ìš°íŒ…
    public String routeToNearestEndpoint(String prompt) {
        String region = determineUserRegion();
        String endpoint = selectEndpoint(region);
        
        return callWithEndpoint(prompt, endpoint);
    }
    
    // 4. í”„ë¦¬í˜ì¹­
    @Component
    public class PrefetchService {
        
        private final Map<String, CompletableFuture<String>> prefetchCache = 
            new ConcurrentHashMap<>();
        
        public void prefetch(String prompt) {
            CompletableFuture<String> future = CompletableFuture
                .supplyAsync(() -> chatClient.prompt()
                    .user(prompt)
                    .call()
                    .content());
            
            prefetchCache.put(prompt, future);
        }
        
        public String getWithPrefetch(String prompt) {
            CompletableFuture<String> cached = prefetchCache.remove(prompt);
            
            if (cached != null && !cached.isCompletedExceptionally()) {
                try {
                    return cached.get(100, TimeUnit.MILLISECONDS);
                } catch (TimeoutException e) {
                    // ìºì‹œ ë¯¸ìŠ¤ë¡œ ì²˜ë¦¬
                }
            }
            
            return callNormally(prompt);
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 4: Memory Issues -->
            <section id="memory-issues" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">4. ë©”ëª¨ë¦¬ ë¬¸ì œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ë©”ëª¨ë¦¬ ëˆ„ìˆ˜</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('memory-leak-fix')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="memory-leak-fix"><code class="language-java">@Component
@Slf4j
public class MemoryManagement {
    
    // ì•½í•œ ì°¸ì¡°ë¥¼ ì‚¬ìš©í•œ ìºì‹œ
    private final Map<String, WeakReference<EmbeddingResult>> embeddingCache = 
        new ConcurrentHashMap<>();
    
    // í¬ê¸° ì œí•œì´ ìˆëŠ” ìºì‹œ
    private final LoadingCache<String, String> responseCache = Caffeine.newBuilder()
        .maximumSize(1000)
        .expireAfterWrite(10, TimeUnit.MINUTES)
        .removalListener((key, value, cause) -> 
            log.debug("Cache entry removed: {}", cause))
        .recordStats()
        .build(this::loadResponse);
    
    // ëŒ€ìš©ëŸ‰ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬
    public void processLargeDataset(Path filePath) {
        try (Stream<String> lines = Files.lines(filePath)) {
            lines.parallel()
                .map(this::processLine)
                .forEach(this::saveResult);
        } catch (IOException e) {
            log.error("Error processing file", e);
        }
    }
    
    // ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§
    @Scheduled(fixedRate = 60000) // 1ë¶„ë§ˆë‹¤
    public void monitorMemory() {
        MemoryMXBean memoryBean = ManagementFactory.getMemoryMXBean();
        MemoryUsage heapUsage = memoryBean.getHeapMemoryUsage();
        
        long used = heapUsage.getUsed() / (1024 * 1024); // MB
        long max = heapUsage.getMax() / (1024 * 1024);
        double percentage = (double) used / max * 100;
        
        if (percentage > 80) {
            log.warn("High memory usage: {}% ({}/{}MB)", 
                String.format("%.1f", percentage), used, max);
            
            // ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œë„
            cleanupMemory();
        }
        
        // ë©”íŠ¸ë¦­ ê¸°ë¡
        meterRegistry.gauge("jvm.memory.used.percentage", percentage);
    }
    
    private void cleanupMemory() {
        // ìºì‹œ ì •ë¦¬
        responseCache.invalidateAll();
        embeddingCache.entrySet().removeIf(entry -> 
            entry.getValue().get() == null);
        
        // ëª…ì‹œì  GC ì œì•ˆ (ì£¼ì˜í•´ì„œ ì‚¬ìš©)
        System.gc();
    }
    
    // ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ì„ë² ë”© ì²˜ë¦¬
    public void processEmbeddingsEfficiently(List<String> texts) {
        int batchSize = 100;
        
        for (int i = 0; i < texts.size(); i += batchSize) {
            List<String> batch = texts.subList(
                i, 
                Math.min(i + batchSize, texts.size())
            );
            
            // ë°°ì¹˜ ì²˜ë¦¬
            List<float[]> embeddings = embeddingModel.embed(batch);
            
            // ì¦‰ì‹œ ì €ì¥í•˜ê³  ë©”ëª¨ë¦¬ì—ì„œ ì œê±°
            saveEmbeddings(embeddings);
            embeddings.clear(); // ëª…ì‹œì  ì •ë¦¬
        }
    }
}</code></pre>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">ë©”ëª¨ë¦¬ ìµœì í™” íŒ</h4>
                        <ul class="space-y-1 text-sm">
                            <li>â€¢ ì ì ˆí•œ JVM í™ í¬ê¸° ì„¤ì • (-Xmx, -Xms)</li>
                            <li>â€¢ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬</li>
                            <li>â€¢ ì•½í•œ ì°¸ì¡°(WeakReference) í™œìš©</li>
                            <li>â€¢ ì •ê¸°ì ì¸ ìºì‹œ ì •ë¦¬</li>
                            <li>â€¢ ë©”ëª¨ë¦¬ í”„ë¡œíŒŒì¼ë§ ë„êµ¬ ì‚¬ìš©</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 5: Vector Store Issues -->
            <section id="vectorstore-issues" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">5. ë²¡í„° ìŠ¤í† ì–´ ë¬¸ì œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ë²¡í„° ê²€ìƒ‰ ì •í™•ë„ ë¬¸ì œ</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('vector-search-accuracy')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="vector-search-accuracy"><code class="language-java">@Service
public class VectorSearchTroubleshooting {
    
    private final VectorStore vectorStore;
    private final EmbeddingModel embeddingModel;
    
    // ê²€ìƒ‰ ì •í™•ë„ ì§„ë‹¨
    public SearchDiagnostics diagnoseSearchAccuracy(String query) {
        // 1. ì¿¼ë¦¬ ì„ë² ë”© ê²€ì¦
        float[] queryEmbedding = embeddingModel.embed(query);
        validateEmbedding(queryEmbedding);
        
        // 2. ë‹¤ì–‘í•œ ì„ê³„ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
        Map<Float, List<Document>> resultsByThreshold = new HashMap<>();
        float[] thresholds = {0.5f, 0.7f, 0.8f, 0.9f};
        
        for (float threshold : thresholds) {
            List<Document> results = vectorStore.similaritySearch(
                SearchRequest.query(query)
                    .withTopK(10)
                    .withSimilarityThreshold(threshold)
            );
            resultsByThreshold.put(threshold, results);
        }
        
        // 3. ê²°ê³¼ ë¶„ì„
        return analyzeResults(query, resultsByThreshold);
    }
    
    private void validateEmbedding(float[] embedding) {
        // ì„ë² ë”© ì •ê·œí™” í™•ì¸
        double norm = calculateNorm(embedding);
        if (Math.abs(norm - 1.0) > 0.01) {
            log.warn("Embedding is not normalized. Norm: {}", norm);
        }
        
        // ì œë¡œ ë²¡í„° í™•ì¸
        boolean isZero = Arrays.stream(embedding).allMatch(v -> v == 0);
        if (isZero) {
            throw new InvalidEmbeddingException("Zero embedding detected");
        }
    }
    
    // ê²€ìƒ‰ ê°œì„  ì „ëµ
    public List<Document> improvedSearch(String query) {
        // 1. ì¿¼ë¦¬ í™•ì¥
        String expandedQuery = expandQuery(query);
        
        // 2. í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
        List<Document> vectorResults = vectorStore.similaritySearch(
            SearchRequest.query(expandedQuery).withTopK(20)
        );
        
        List<Document> keywordResults = performKeywordSearch(query);
        
        // 3. ê²°ê³¼ ì¬ìˆœìœ„í™”
        return rerankResults(vectorResults, keywordResults, query);
    }
    
    // ì¸ë±ìŠ¤ ë¬¸ì œ í•´ê²°
    @Component
    public class VectorIndexOptimizer {
        
        public void optimizeIndex() {
            // PGVector HNSW ì¸ë±ìŠ¤ ì¬êµ¬ì¶•
            jdbcTemplate.execute("""
                REINDEX INDEX CONCURRENTLY vector_embedding_idx;
                
                -- ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° ì¡°ì •
                ALTER INDEX vector_embedding_idx SET (
                    m = 16,
                    ef_construction = 64
                );
                
                -- í†µê³„ ì—…ë°ì´íŠ¸
                ANALYZE vector_store;
            """);
        }
        
        public void diagnoseIndexPerformance() {
            // ì¸ë±ìŠ¤ ì‚¬ìš© í™•ì¸
            List<Map<String, Object>> explainResult = jdbcTemplate.queryForList("""
                EXPLAIN (ANALYZE, BUFFERS) 
                SELECT * FROM vector_store 
                ORDER BY embedding <-> '[0.1, 0.2, ...]'::vector 
                LIMIT 10;
            """);
            
            log.info("Query plan: {}", explainResult);
        }
    }
}</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold mb-3 mt-6">ë²¡í„° ìŠ¤í† ì–´ ì—°ê²° ë¬¸ì œ</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('vector-connection-issues')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="vector-connection-issues"><code class="language-java">@Component
public class VectorStoreConnectionDiagnostics {
    
    @Autowired
    private VectorStore vectorStore;
    
    @PostConstruct
    public void validateConnection() {
        try {
            // ì—°ê²° í…ŒìŠ¤íŠ¸
            testBasicOperations();
            log.info("Vector store connection validated successfully");
        } catch (Exception e) {
            log.error("Vector store connection failed", e);
            diagnoseConnectionIssue(e);
        }
    }
    
    private void testBasicOperations() {
        // 1. ì“°ê¸° í…ŒìŠ¤íŠ¸
        Document testDoc = new Document("test content");
        testDoc.getMetadata().put("test", true);
        vectorStore.add(List.of(testDoc));
        
        // 2. ì½ê¸° í…ŒìŠ¤íŠ¸
        List<Document> results = vectorStore.similaritySearch(
            SearchRequest.query("test").withTopK(1)
        );
        
        if (results.isEmpty()) {
            throw new VectorStoreException("Read test failed");
        }
        
        // 3. ì‚­ì œ í…ŒìŠ¤íŠ¸ (ì •ë¦¬)
        // vectorStore.delete(List.of(testDoc.getId()));
    }
    
    private void diagnoseConnectionIssue(Exception e) {
        if (e.getMessage().contains("connection refused")) {
            log.error("Vector store is not running. Check if the service is started.");
            log.error("For PGVector: sudo systemctl status postgresql");
            log.error("For Chroma: chroma run --host localhost --port 8000");
        } else if (e.getMessage().contains("extension")) {
            log.error("PGVector extension not installed. Run: CREATE EXTENSION vector;");
        } else if (e.getMessage().contains("authentication")) {
            log.error("Authentication failed. Check credentials in application.yml");
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 6: Debugging Techniques -->
            <section id="debugging-techniques" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">6. ë””ë²„ê¹… ê¸°ë²•</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ìš”ì²­/ì‘ë‹µ ë¡œê¹…</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('request-response-logging')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="request-response-logging"><code class="language-java">@Component
@Slf4j
public class AIDebugInterceptor {
    
    @EventListener
    public void onChatRequest(ChatRequestEvent event) {
        if (log.isDebugEnabled()) {
            log.debug("=== AI Request ===");
            log.debug("Model: {}", event.getModel());
            log.debug("Temperature: {}", event.getTemperature());
            log.debug("System: {}", truncate(event.getSystemMessage(), 200));
            log.debug("User: {}", truncate(event.getUserMessage(), 200));
            log.debug("Timestamp: {}", Instant.now());
            log.debug("==================");
        }
    }
    
    @EventListener
    public void onChatResponse(ChatResponseEvent event) {
        if (log.isDebugEnabled()) {
            log.debug("=== AI Response ===");
            log.debug("Request ID: {}", event.getRequestId());
            log.debug("Duration: {}ms", event.getDuration());
            log.debug("Tokens: {}", event.getTokensUsed());
            log.debug("Response: {}", truncate(event.getResponse(), 500));
            log.debug("===================");
        }
    }
    
    // ì¡°ê±´ë¶€ ìƒì„¸ ë¡œê¹…
    @Component
    public class ConditionalLogger {
        
        private final Set<String> debugUsers = new HashSet<>();
        
        public void enableDebugForUser(String userId) {
            debugUsers.add(userId);
        }
        
        public void logIfEnabled(String userId, String message, Object... args) {
            if (debugUsers.contains(userId)) {
                log.info("[DEBUG-USER:{}] " + message, userId, args);
            }
        }
    }
    
    // í”„ë¡¬í”„íŠ¸ ì¶”ì 
    @Aspect
    @Component
    public class PromptTracingAspect {
        
        @Around("@annotation(TracePrompt)")
        public Object tracePrompt(ProceedingJoinPoint pjp) throws Throwable {
            String traceId = UUID.randomUUID().toString();
            MDC.put("traceId", traceId);
            
            try {
                log.info("Prompt trace started");
                
                Object result = pjp.proceed();
                
                log.info("Prompt trace completed");
                return result;
            } finally {
                MDC.remove("traceId");
            }
        }
    }
}</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold mb-3 mt-6">ìƒíƒœ ë¤í”„</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('state-dump')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="state-dump"><code class="language-java">@RestController
@RequestMapping("/debug")
public class DebugController {
    
    @Autowired
    private ApplicationContext context;
    
    @Autowired
    private MeterRegistry meterRegistry;
    
    @GetMapping("/state")
    public ResponseEntity<SystemState> getSystemState() {
        SystemState state = SystemState.builder()
            .timestamp(Instant.now())
            .activeConnections(getActiveConnections())
            .cacheStats(getCacheStats())
            .queueSizes(getQueueSizes())
            .errorRates(getErrorRates())
            .memoryUsage(getMemoryUsage())
            .threadInfo(getThreadInfo())
            .build();
        
        return ResponseEntity.ok(state);
    }
    
    @GetMapping("/config")
    public Map<String, Object> getConfiguration() {
        Map<String, Object> config = new HashMap<>();
        
        // AI ì„¤ì •
        config.put("chatModel", getPropertySafely("spring.ai.openai.chat.model"));
        config.put("temperature", getPropertySafely("spring.ai.openai.chat.temperature"));
        config.put("maxTokens", getPropertySafely("spring.ai.openai.chat.max-tokens"));
        
        // ë²¡í„° ìŠ¤í† ì–´ ì„¤ì •
        config.put("vectorStore", getVectorStoreConfig());
        
        // ì„±ëŠ¥ ì„¤ì •
        config.put("connectionPool", getConnectionPoolConfig());
        
        return config;
    }
    
    @PostMapping("/test-prompt")
    public TestResult testPrompt(@RequestBody TestRequest request) {
        long startTime = System.currentTimeMillis();
        
        try {
            String response = chatClient.prompt()
                .user(request.getPrompt())
                .call()
                .content();
            
            return TestResult.success(
                response,
                System.currentTimeMillis() - startTime
            );
        } catch (Exception e) {
            return TestResult.failure(
                e.getMessage(),
                System.currentTimeMillis() - startTime
            );
        }
    }
    
    // í™ ë¤í”„ ìƒì„± (ì£¼ì˜: í”„ë¡œë•ì…˜ì—ì„œëŠ” ì‹ ì¤‘íˆ ì‚¬ìš©)
    @PostMapping("/heap-dump")
    public ResponseEntity<String> createHeapDump() {
        if (!isDebugMode()) {
            return ResponseEntity.status(403).body("Not allowed in production");
        }
        
        try {
            String fileName = "heap-dump-" + System.currentTimeMillis() + ".hprof";
            MBeanServer server = ManagementFactory.getPlatformMBeanServer();
            HotSpotDiagnosticMXBean mxBean = ManagementFactory.newPlatformMXBeanProxy(
                server,
                "com.sun.management:type=HotSpotDiagnostic",
                HotSpotDiagnosticMXBean.class
            );
            mxBean.dumpHeap(fileName, true);
            
            return ResponseEntity.ok("Heap dump created: " + fileName);
        } catch (Exception e) {
            return ResponseEntity.status(500).body("Failed: " + e.getMessage());
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 7: Production Issues -->
            <section id="production-issues" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">7. í”„ë¡œë•ì…˜ ë¬¸ì œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ëŒ€ì‘</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('service-outage')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="service-outage"><code class="language-java">@Service
@Slf4j
public class OutageHandlingService {
    
    private final CircuitBreaker circuitBreaker;
    private final FallbackService fallbackService;
    
    public OutageHandlingService() {
        this.circuitBreaker = CircuitBreaker.ofDefaults("ai-service");
        circuitBreaker.getEventPublisher()
            .onStateTransition(event -> 
                log.warn("Circuit breaker state transition: {}", event));
    }
    
    public String handleRequest(String prompt) {
        return circuitBreaker.executeSupplier(
            () -> callAIService(prompt),
            throwable -> {
                log.error("AI service call failed, using fallback", throwable);
                return fallbackService.getFallbackResponse(prompt);
            }
        );
    }
    
    // ë‹¤ì¤‘ í”„ë¡œë°”ì´ë” í´ë°±
    @Component
    public class MultiProviderFallback {
        
        private final List<AIProvider> providers = List.of(
            new OpenAIProvider(),
            new AnthropicProvider(),
            new LocalModelProvider()
        );
        
        public String executeWithFallback(String prompt) {
            for (AIProvider provider : providers) {
                try {
                    if (provider.isAvailable()) {
                        return provider.execute(prompt);
                    }
                } catch (Exception e) {
                    log.warn("Provider {} failed", provider.getName(), e);
                }
            }
            
            // ëª¨ë“  í”„ë¡œë°”ì´ë” ì‹¤íŒ¨
            return getCachedOrDefaultResponse(prompt);
        }
    }
    
    // ì¥ì•  ìë™ ë³µêµ¬
    @Component
    public class AutoRecoveryService {
        
        @Scheduled(fixedDelay = 60000) // 1ë¶„ë§ˆë‹¤
        public void checkAndRecover() {
            if (circuitBreaker.getState() == CircuitBreaker.State.OPEN) {
                log.info("Attempting to recover from outage");
                
                // í—¬ìŠ¤ ì²´í¬
                if (performHealthCheck()) {
                    circuitBreaker.reset();
                    log.info("Service recovered, circuit breaker reset");
                    
                    // ì•Œë¦¼ ë°œì†¡
                    notificationService.sendRecoveryNotification();
                }
            }
        }
        
        private boolean performHealthCheck() {
            try {
                String response = chatClient.prompt()
                    .user("ping")
                    .call()
                    .content();
                return response != null && !response.isEmpty();
            } catch (Exception e) {
                return false;
            }
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 8: Troubleshooting Tools -->
            <section id="troubleshooting-tools" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">8. ë¬¸ì œ í•´ê²° ë„êµ¬</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì§„ë‹¨ ë„êµ¬ ëª¨ìŒ</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('diagnostic-tools')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="diagnostic-tools"><code class="language-java">@Component
public class DiagnosticToolkit {
    
    // ì¢…í•© ì§„ë‹¨ ë¦¬í¬íŠ¸
    public DiagnosticReport runFullDiagnostics() {
        DiagnosticReport report = new DiagnosticReport();
        
        // 1. API ì—°ê²° í…ŒìŠ¤íŠ¸
        report.addSection("API Connectivity", testAPIConnectivity());
        
        // 2. ì„±ëŠ¥ ë©”íŠ¸ë¦­
        report.addSection("Performance Metrics", collectPerformanceMetrics());
        
        // 3. ì—ëŸ¬ ë¶„ì„
        report.addSection("Error Analysis", analyzeRecentErrors());
        
        // 4. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
        report.addSection("Resource Usage", checkResourceUsage());
        
        // 5. ì„¤ì • ê²€ì¦
        report.addSection("Configuration", validateConfiguration());
        
        return report;
    }
    
    // ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
    @RestController
    @RequestMapping("/diagnostics")
    public class DiagnosticsDashboard {
        
        @GetMapping("/live")
        public ResponseEntity<LiveMetrics> getLiveMetrics() {
            return ResponseEntity.ok(LiveMetrics.builder()
                .requestsPerSecond(getCurrentRPS())
                .averageLatency(getAverageLatency())
                .errorRate(getErrorRate())
                .activeConnections(getActiveConnections())
                .queueDepth(getQueueDepth())
                .build());
        }
        
        @PostMapping("/trace")
        public TraceResult traceRequest(@RequestBody TraceRequest request) {
            // ìš”ì²­ ì¶”ì  í™œì„±í™”
            enableTracing(request.getTraceId());
            
            try {
                // ì¶”ì ëœ ìš”ì²­ ì‹¤í–‰
                String result = executeWithTracing(request);
                
                // ì¶”ì  ê²°ê³¼ ìˆ˜ì§‘
                return collectTraceResult(request.getTraceId());
            } finally {
                disableTracing(request.getTraceId());
            }
        }
    }
    
    // ìë™ ë¬¸ì œ ê°ì§€
    @Component
    public class AutomaticIssueDetecion {
        
        private final List<IssueDetector> detectors = List.of(
            new SlowResponseDetector(),
            new HighErrorRateDetector(),
            new MemoryLeakDetector(),
            new ConnectionPoolExhaustionDetector()
        );
        
        @Scheduled(fixedRate = 30000) // 30ì´ˆë§ˆë‹¤
        public void detectIssues() {
            for (IssueDetector detector : detectors) {
                Optional<Issue> issue = detector.detect();
                
                if (issue.isPresent()) {
                    handleDetectedIssue(issue.get());
                }
            }
        }
        
        private void handleDetectedIssue(Issue issue) {
            log.error("Issue detected: {}", issue);
            
            // ìë™ í•´ê²° ì‹œë„
            if (issue.hasAutoFix()) {
                issue.applyAutoFix();
            }
            
            // ì•Œë¦¼ ë°œì†¡
            alertManager.sendIssueAlert(issue);
            
            // ë©”íŠ¸ë¦­ ê¸°ë¡
            meterRegistry.counter("issues.detected",
                "type", issue.getType(),
                "severity", issue.getSeverity()
            ).increment();
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Best Practices -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ğŸ¯ ë¬¸ì œ í•´ê²° Best Practices</h2>
                
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="font-semibold mb-3">ì˜ˆë°© ì¡°ì¹˜</h3>
                            <ul class="space-y-1 text-sm">
                                <li>âœ… í¬ê´„ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ êµ¬í˜„</li>
                                <li>âœ… ì ì ˆí•œ íƒ€ì„ì•„ì›ƒ ì„¤ì •</li>
                                <li>âœ… ì¬ì‹œë„ ë¡œì§ êµ¬í˜„</li>
                                <li>âœ… ì„œí‚· ë¸Œë ˆì´ì»¤ íŒ¨í„´ ì ìš©</li>
                                <li>âœ… ì •ê¸°ì ì¸ í—¬ìŠ¤ ì²´í¬</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold mb-3">ì§„ë‹¨ ì „ëµ</h3>
                            <ul class="space-y-1 text-sm">
                                <li>âœ… ìƒì„¸í•œ ë¡œê¹… êµ¬í˜„</li>
                                <li>âœ… ë¶„ì‚° ì¶”ì  í™œìš©</li>
                                <li>âœ… ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ë¶„ì„</li>
                                <li>âœ… ì •ê¸°ì ì¸ ì„±ëŠ¥ í”„ë¡œíŒŒì¼ë§</li>
                                <li>âœ… ìë™í™”ëœ ë¬¸ì œ ê°ì§€</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="font-semibold mb-3">ë¬¸ì œ í•´ê²° ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                        <div class="bg-white p-4 rounded-lg">
                            <ul class="space-y-1 text-sm">
                                <li>â–¡ ì—ëŸ¬ ë¡œê·¸ í™•ì¸</li>
                                <li>â–¡ API í‚¤ ë° í™˜ê²½ ë³€ìˆ˜ ê²€ì¦</li>
                                <li>â–¡ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ í™•ì¸</li>
                                <li>â–¡ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì ê²€</li>
                                <li>â–¡ ìµœê·¼ ë³€ê²½ì‚¬í•­ ê²€í† </li>
                                <li>â–¡ ì˜ì¡´ì„± ë²„ì „ í™•ì¸</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Next Steps -->
            <section class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-xl font-semibold mb-4">ë‹¤ìŒ ë‹¨ê³„</h2>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <a href="monitoring.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-blue-600 mb-2">ëª¨ë‹ˆí„°ë§</h3>
                        <p class="text-sm text-gray-600">ë¬¸ì œ ì˜ˆë°©ì„ ìœ„í•œ ëª¨ë‹ˆí„°ë§ êµ¬ì¶•</p>
                    </a>
                    
                    <a href="performance.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-green-600 mb-2">ì„±ëŠ¥ ìµœì í™”</h3>
                        <p class="text-sm text-gray-600">ì„±ëŠ¥ ë¬¸ì œ í•´ê²° ë° ìµœì í™”</p>
                    </a>
                    
                    <a href="patterns.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-purple-600 mb-2">ì•ˆì •ì„± íŒ¨í„´</h3>
                        <p class="text-sm text-gray-600">ì¥ì•  ëŒ€ì‘ íŒ¨í„´ êµ¬í˜„</p>
                    </a>
                </div>
            </section>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        function copyCode(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }
    </script>
</body>
</html>