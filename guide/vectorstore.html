<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring AI ë²¡í„° ìŠ¤í† ì–´ ê°€ì´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .code-block { background: #2d3748; border-radius: 8px; }
        .copy-button { transition: all 0.2s ease; }
        .copy-button:hover { background-color: #4a5568; }
        .comparison-table { font-size: 0.875rem; }
        .comparison-table td, .comparison-table th { padding: 0.75rem; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <a href="../index.html" class="flex items-center text-xl font-bold text-gray-800">
                        <i class="fab fa-spring text-green-600 mr-2"></i>
                        Spring AI Hub
                    </a>
                    <span class="mx-3 text-gray-400">/</span>
                    <span class="text-gray-600">ë²¡í„° ìŠ¤í† ì–´ ê°€ì´ë“œ</span>
                </div>
                <a href="../index.html" class="text-blue-600 hover:text-blue-800">
                    <i class="fas fa-home"></i> í™ˆìœ¼ë¡œ
                </a>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl font-bold mb-4">ğŸ—„ï¸ ë²¡í„° ìŠ¤í† ì–´ ì™„ë²½ ê°€ì´ë“œ</h1>
            <p class="text-gray-600 mb-8">Spring AIì—ì„œ ì§€ì›í•˜ëŠ” ëª¨ë“  ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ì˜ ì„¤ì •ê³¼ ì‚¬ìš©ë²•</p>

            <!-- Table of Contents -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">ëª©ì°¨</h2>
                <ul class="space-y-2 text-blue-600">
                    <li><a href="#introduction" class="hover:underline">1. ë²¡í„° ìŠ¤í† ì–´ë€?</a></li>
                    <li><a href="#comparison" class="hover:underline">2. ë²¡í„° ìŠ¤í† ì–´ ë¹„êµ</a></li>
                    <li><a href="#pgvector" class="hover:underline">3. PostgreSQL + PGVector</a></li>
                    <li><a href="#chroma" class="hover:underline">4. Chroma</a></li>
                    <li><a href="#pinecone" class="hover:underline">5. Pinecone</a></li>
                    <li><a href="#qdrant" class="hover:underline">6. Qdrant</a></li>
                    <li><a href="#optimization" class="hover:underline">7. ì„±ëŠ¥ ìµœì í™”</a></li>
                    <li><a href="#migration" class="hover:underline">8. ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ</a></li>
                </ul>
            </div>

            <!-- Section 1: Introduction -->
            <section id="introduction" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">1. ë²¡í„° ìŠ¤í† ì–´ë€?</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <p class="mb-4">
                        ë²¡í„° ìŠ¤í† ì–´ëŠ” ê³ ì°¨ì› ë²¡í„° ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥í•˜ê³  ê²€ìƒ‰í•˜ëŠ” íŠ¹ìˆ˜í•œ ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤.
                        AI ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, ì˜¤ë””ì˜¤ ë“±ì˜ ì„ë² ë”©ì„ ì €ì¥í•˜ê³  ìœ ì‚¬ë„ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
                    </p>
                    
                    <div class="bg-blue-50 p-4 rounded-lg mb-4">
                        <h3 class="font-semibold mb-2">í•µì‹¬ ê¸°ëŠ¥:</h3>
                        <ul class="space-y-1">
                            <li>ğŸ“Š <strong>ê³ ì°¨ì› ë²¡í„° ì €ì¥</strong>: ìˆ˜ë°±~ìˆ˜ì²œ ì°¨ì›ì˜ ë²¡í„° íš¨ìœ¨ì  ì €ì¥</li>
                            <li>ğŸ” <strong>ìœ ì‚¬ë„ ê²€ìƒ‰</strong>: ì½”ì‚¬ì¸ ìœ ì‚¬ë„, ìœ í´ë¦¬ë“œ ê±°ë¦¬ ë“±</li>
                            <li>âš¡ <strong>ë¹ ë¥¸ ê²€ìƒ‰</strong>: ì¸ë±ì‹±ì„ í†µí•œ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ ê²€ìƒ‰</li>
                            <li>ğŸ”§ <strong>ë©”íƒ€ë°ì´í„° ì§€ì›</strong>: ë²¡í„°ì™€ í•¨ê»˜ ì¶”ê°€ ì •ë³´ ì €ì¥</li>
                            <li>ğŸ“ˆ <strong>í™•ì¥ì„±</strong>: ìˆ˜ë°±ë§Œ~ìˆ˜ì‹­ì–µ ê°œì˜ ë²¡í„° ì²˜ë¦¬</li>
                        </ul>
                    </div>

                    <div class="bg-gray-100 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">ë²¡í„° ìŠ¤í† ì–´ ì›Œí¬í”Œë¡œìš°:</h3>
                        <pre class="text-sm">
1. í…ìŠ¤íŠ¸/ì´ë¯¸ì§€/ì˜¤ë””ì˜¤ ì…ë ¥
    â†“
2. ì„ë² ë”© ëª¨ë¸ë¡œ ë²¡í„° ë³€í™˜ (ì˜ˆ: 1536ì°¨ì›)
    â†“
3. ë²¡í„° + ë©”íƒ€ë°ì´í„° ì €ì¥
    â†“
4. ì¿¼ë¦¬ë¥¼ ë²¡í„°ë¡œ ë³€í™˜
    â†“
5. ìœ ì‚¬ë„ ê¸°ë°˜ ê²€ìƒ‰
    â†“
6. Top-K ê²°ê³¼ ë°˜í™˜
                        </pre>
                    </div>
                </div>
            </section>

            <!-- Section 2: Comparison -->
            <section id="comparison" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">2. ë²¡í„° ìŠ¤í† ì–´ ë¹„êµ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 overflow-x-auto">
                    <table class="w-full comparison-table">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="text-left font-semibold">ë²¡í„° ìŠ¤í† ì–´</th>
                                <th class="text-left">íƒ€ì…</th>
                                <th class="text-left">íŠ¹ì§•</th>
                                <th class="text-left">ì í•©í•œ ê²½ìš°</th>
                                <th class="text-left">ë¹„ìš©</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y">
                            <tr>
                                <td class="font-medium">PGVector</td>
                                <td>ì˜¤í”ˆì†ŒìŠ¤</td>
                                <td>PostgreSQL í™•ì¥, ACID ì§€ì›</td>
                                <td>ê¸°ì¡´ PostgreSQL ì‚¬ìš© ì¤‘</td>
                                <td>ë¬´ë£Œ</td>
                            </tr>
                            <tr>
                                <td class="font-medium">Chroma</td>
                                <td>ì˜¤í”ˆì†ŒìŠ¤</td>
                                <td>ê²½ëŸ‰, ë¡œì»¬ ê°œë°œ ìµœì í™”</td>
                                <td>í”„ë¡œí† íƒ€ì…, ë¡œì»¬ ê°œë°œ</td>
                                <td>ë¬´ë£Œ</td>
                            </tr>
                            <tr>
                                <td class="font-medium">Pinecone</td>
                                <td>ê´€ë¦¬í˜• SaaS</td>
                                <td>ì™„ì „ ê´€ë¦¬í˜•, ìë™ í™•ì¥</td>
                                <td>ëŒ€ê·œëª¨ í”„ë¡œë•ì…˜</td>
                                <td>ìœ ë£Œ</td>
                            </tr>
                            <tr>
                                <td class="font-medium">Qdrant</td>
                                <td>ì˜¤í”ˆì†ŒìŠ¤/í´ë¼ìš°ë“œ</td>
                                <td>ê³ ì„±ëŠ¥, í•„í„°ë§ ê°•ë ¥</td>
                                <td>ë³µì¡í•œ í•„í„°ë§ í•„ìš”</td>
                                <td>ë¬´ë£Œ/ìœ ë£Œ</td>
                            </tr>
                            <tr>
                                <td class="font-medium">Weaviate</td>
                                <td>ì˜¤í”ˆì†ŒìŠ¤/í´ë¼ìš°ë“œ</td>
                                <td>GraphQL API, ëª¨ë“ˆì‹</td>
                                <td>ê·¸ë˜í”„ ê¸°ë°˜ ê²€ìƒ‰</td>
                                <td>ë¬´ë£Œ/ìœ ë£Œ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="grid md:grid-cols-2 gap-6 mt-6">
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">ë¡œì»¬ ê°œë°œ ì¶”ì²œ</h3>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸ¥‡ <strong>Chroma</strong>: ê°€ì¥ ê°„ë‹¨í•œ ì„¤ì •</li>
                            <li>ğŸ¥ˆ <strong>PGVector</strong>: ê¸°ì¡´ PostgreSQL í™œìš©</li>
                            <li>ğŸ¥‰ <strong>Qdrant</strong>: Dockerë¡œ ì‰½ê²Œ ì‹œì‘</li>
                        </ul>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">í”„ë¡œë•ì…˜ ì¶”ì²œ</h3>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸ¥‡ <strong>Pinecone</strong>: ê´€ë¦¬ ë¶€ë‹´ ìµœì†Œí™”</li>
                            <li>ğŸ¥ˆ <strong>PGVector</strong>: ë¹„ìš© íš¨ìœ¨ì </li>
                            <li>ğŸ¥‰ <strong>Qdrant Cloud</strong>: ê· í˜•ì¡íŒ ì„ íƒ</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 3: PGVector -->
            <section id="pgvector" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">3. PostgreSQL + PGVector</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì„¤ì¹˜ ë° ì„¤ì •</h3>
                    
                    <!-- Docker Setup -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Dockerë¡œ ì„¤ì¹˜</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('pgvector-docker')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="pgvector-docker"><code class="language-bash"># Docker Compose íŒŒì¼
cat > docker-compose.yml << EOF
version: '3.8'
services:
  postgres:
    image: ankane/pgvector:latest
    environment:
      POSTGRES_USER: vectoruser
      POSTGRES_PASSWORD: vectorpass
      POSTGRES_DB: vectordb
    ports:
      - "5432:5432"
    volumes:
      - pgvector_data:/var/lib/postgresql/data

volumes:
  pgvector_data:
EOF

# ì‹¤í–‰
docker-compose up -d</code></pre>
                        </div>
                    </div>

                    <!-- Spring Configuration -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Spring ì„¤ì •</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('pgvector-config')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="pgvector-config"><code class="language-yaml">spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/vectordb
    username: vectoruser
    password: vectorpass
    driver-class-name: org.postgresql.Driver
  
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  
  ai:
    vectorstore:
      pgvector:
        index-type: HNSW  # HNSW, IVFFLAT ì¤‘ ì„ íƒ
        distance-type: COSINE_DISTANCE  # COSINE_DISTANCE, L2_DISTANCE, INNER_PRODUCT
        dimensions: 1536  # OpenAI ì„ë² ë”© ì°¨ì›
        
        # HNSW ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„°
        hnsw:
          m: 16  # ì—°ê²° ìˆ˜ (ê¸°ë³¸ê°’: 16)
          ef-construction: 64  # êµ¬ì¶• ì‹œ ê²€ìƒ‰ ë²”ìœ„ (ê¸°ë³¸ê°’: 64)
          
        # í…Œì´ë¸” ì„¤ì •
        schema-name: public
        table-name: vector_store
        initialize-schema: true</code></pre>
                        </div>
                    </div>

                    <!-- Service Implementation -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì„œë¹„ìŠ¤ êµ¬í˜„</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('pgvector-service')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="pgvector-service"><code class="language-java">@Service
@Slf4j
public class PGVectorService {
    
    private final VectorStore vectorStore;
    private final JdbcTemplate jdbcTemplate;
    
    public PGVectorService(VectorStore vectorStore, JdbcTemplate jdbcTemplate) {
        this.vectorStore = vectorStore;
        this.jdbcTemplate = jdbcTemplate;
    }
    
    // ë¬¸ì„œ ì €ì¥
    public void saveDocuments(List<Document> documents) {
        // ë©”íƒ€ë°ì´í„° ì¶”ê°€
        documents.forEach(doc -> {
            doc.getMetadata().put("created_at", Instant.now().toString());
            doc.getMetadata().put("version", "1.0");
        });
        
        vectorStore.add(documents);
        log.info("Saved {} documents to PGVector", documents.size());
    }
    
    // ìœ ì‚¬ë„ ê²€ìƒ‰
    public List<Document> search(String query, SearchOptions options) {
        return vectorStore.similaritySearch(
            SearchRequest.query(query)
                .withTopK(options.getTopK())
                .withSimilarityThreshold(options.getThreshold())
                .withFilterExpression(options.getFilter())
        );
    }
    
    // ì§ì ‘ SQL ì¿¼ë¦¬ (ê³ ê¸‰ ê¸°ëŠ¥)
    public List<SimilarityResult> advancedSearch(String queryVector, int limit) {
        String sql = """
            SELECT 
                content,
                metadata,
                1 - (embedding <=> ?::vector) as similarity
            FROM vector_store
            WHERE 1 - (embedding <=> ?::vector) > 0.7
            ORDER BY embedding <=> ?::vector
            LIMIT ?
            """;
        
        return jdbcTemplate.query(sql, 
            new Object[]{queryVector, queryVector, queryVector, limit},
            (rs, rowNum) -> SimilarityResult.builder()
                .content(rs.getString("content"))
                .metadata(parseJsonb(rs.getString("metadata")))
                .similarity(rs.getDouble("similarity"))
                .build()
        );
    }
    
    // ì¸ë±ìŠ¤ ìµœì í™”
    @Scheduled(cron = "0 0 2 * * *") // ë§¤ì¼ ìƒˆë²½ 2ì‹œ
    public void optimizeIndex() {
        log.info("Starting PGVector index optimization");
        
        // VACUUM ANALYZE ì‹¤í–‰
        jdbcTemplate.execute("VACUUM ANALYZE vector_store");
        
        // ì¸ë±ìŠ¤ ë¦¬ë¹Œë“œ (í•„ìš”ì‹œ)
        long tableSize = getTableSize();
        if (tableSize > 1_000_000) { // 100ë§Œ ê°œ ì´ìƒ
            jdbcTemplate.execute("REINDEX INDEX vector_store_embedding_idx");
        }
        
        log.info("PGVector index optimization completed");
    }
    
    // í†µê³„ ì •ë³´
    public VectorStoreStats getStats() {
        String sql = """
            SELECT 
                COUNT(*) as total_vectors,
                pg_size_pretty(pg_relation_size('vector_store')) as table_size,
                pg_size_pretty(pg_relation_size('vector_store_embedding_idx')) as index_size
            FROM vector_store
            """;
        
        return jdbcTemplate.queryForObject(sql, (rs, rowNum) -> 
            VectorStoreStats.builder()
                .totalVectors(rs.getLong("total_vectors"))
                .tableSize(rs.getString("table_size"))
                .indexSize(rs.getString("index_size"))
                .build()
        );
    }
}</code></pre>
                        </div>
                    </div>

                    <!-- Performance Tips -->
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">ì„±ëŠ¥ ìµœì í™” íŒ</h4>
                        <ul class="space-y-1 text-sm">
                            <li>â€¢ HNSW ì¸ë±ìŠ¤ëŠ” êµ¬ì¶•ì´ ëŠë¦¬ì§€ë§Œ ê²€ìƒ‰ì´ ë¹ ë¦„ (ëŒ€ê·œëª¨ ë°ì´í„°)</li>
                            <li>â€¢ IVFFlatì€ êµ¬ì¶•ì´ ë¹ ë¥´ì§€ë§Œ ì •í™•ë„ê°€ ì•½ê°„ ë‚®ìŒ (ì¤‘ì†Œê·œëª¨)</li>
                            <li>â€¢ ef_search íŒŒë¼ë¯¸í„°ë¡œ ì†ë„/ì •í™•ë„ íŠ¸ë ˆì´ë“œì˜¤í”„ ì¡°ì •</li>
                            <li>â€¢ ì •ê¸°ì ì¸ VACUUM ANALYZEë¡œ ì„±ëŠ¥ ìœ ì§€</li>
                            <li>â€¢ íŒŒí‹°ì…”ë‹ìœ¼ë¡œ ëŒ€ê·œëª¨ ë°ì´í„° ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: Chroma -->
            <section id="chroma" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">4. Chroma</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì„¤ì¹˜ ë° ì„¤ì •</h3>
                    
                    <!-- Local Setup -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ë¡œì»¬ ì„¤ì¹˜</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('chroma-setup')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="chroma-setup"><code class="language-bash"># Pythonìœ¼ë¡œ Chroma ì„œë²„ ì‹¤í–‰
pip install chromadb

# ì„œë²„ ì‹œì‘
chroma run --host localhost --port 8000

# ë˜ëŠ” Docker ì‚¬ìš©
docker run -p 8000:8000 ghcr.io/chroma-core/chroma:latest</code></pre>
                        </div>
                    </div>

                    <!-- Spring Configuration -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Spring ì„¤ì •</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('chroma-config')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="chroma-config"><code class="language-yaml">spring:
  ai:
    vectorstore:
      chroma:
        host: localhost
        port: 8000
        collection-name: spring-ai-collection
        
        # ì„ë² ë”© ì„¤ì •
        embedding-dimension: 1536
        
        # ì„ íƒì  ì„¤ì •
        log-requests: true
        timeout: 30s</code></pre>
                        </div>
                    </div>

                    <!-- Service Implementation -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì„œë¹„ìŠ¤ êµ¬í˜„</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('chroma-service')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="chroma-service"><code class="language-java">@Service
@Slf4j
public class ChromaVectorService {
    
    private final VectorStore vectorStore;
    private final ChromaApi chromaApi;
    
    public ChromaVectorService(@Qualifier("chromaVectorStore") VectorStore vectorStore) {
        this.vectorStore = vectorStore;
        this.chromaApi = ((ChromaVectorStore) vectorStore).getChromaApi();
    }
    
    // ì»¬ë ‰ì…˜ ê´€ë¦¬
    public void createCollection(String name, Map<String, Object> metadata) {
        chromaApi.createCollection(
            CreateCollectionRequest.builder()
                .name(name)
                .metadata(metadata)
                .build()
        );
        log.info("Created Chroma collection: {}", name);
    }
    
    // ë¬¸ì„œ ì¶”ê°€ (ë°°ì¹˜)
    public void addDocumentsBatch(List<Document> documents, int batchSize) {
        List<List<Document>> batches = partition(documents, batchSize);
        
        batches.parallelStream().forEach(batch -> {
            vectorStore.add(batch);
            log.debug("Added batch of {} documents", batch.size());
        });
        
        log.info("Added {} documents in {} batches", documents.size(), batches.size());
    }
    
    // ë©”íƒ€ë°ì´í„° í•„í„°ë§ ê²€ìƒ‰
    public List<Document> searchWithMetadata(String query, Map<String, Object> metadataFilter) {
        // Chromaì˜ where ì ˆ êµ¬ì„±
        Map<String, Object> whereClause = new HashMap<>();
        metadataFilter.forEach((key, value) -> {
            if (value instanceof List) {
                whereClause.put(key, Map.of("$in", value));
            } else {
                whereClause.put(key, Map.of("$eq", value));
            }
        });
        
        return vectorStore.similaritySearch(
            SearchRequest.query(query)
                .withTopK(10)
                .withFilterExpression(buildFilterExpression(whereClause))
        );
    }
    
    // í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (ì„ë² ë”© + ì „ë¬¸ ê²€ìƒ‰)
    public List<Document> hybridSearch(String query, HybridSearchOptions options) {
        // 1. ë²¡í„° ê²€ìƒ‰
        List<Document> vectorResults = vectorStore.similaritySearch(
            SearchRequest.query(query)
                .withTopK(options.getVectorTopK())
        );
        
        // 2. í…ìŠ¤íŠ¸ ê²€ìƒ‰ (Chromaì˜ ë‚´ì¥ ê¸°ëŠ¥ ì‚¬ìš©)
        List<Document> textResults = chromaApi.query(
            QueryRequest.builder()
                .collectionName(collectionName)
                .queryTexts(List.of(query))
                .nResults(options.getTextTopK())
                .whereDocument(Map.of("$contains", query))
                .build()
        ).getDocuments();
        
        // 3. ê²°ê³¼ ë³‘í•© ë° ì¬ìˆœìœ„í™”
        return mergeAndRerank(vectorResults, textResults, options);
    }
    
    // ì»¬ë ‰ì…˜ í†µê³„
    public CollectionStats getStats() {
        Collection collection = chromaApi.getCollection(collectionName);
        
        return CollectionStats.builder()
            .name(collection.getName())
            .count(collection.getCount())
            .metadata(collection.getMetadata())
            .build();
    }
    
    // ì„ë² ë”© ì§ì ‘ ê´€ë¦¬
    public void addWithCustomEmbeddings(String content, float[] embedding, Map<String, Object> metadata) {
        Document doc = new Document(content, metadata);
        doc.setEmbedding(embedding);
        
        vectorStore.add(List.of(doc));
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">Chroma ì¥ì </h4>
                        <ul class="space-y-1 text-sm">
                            <li>âœ… ì„¤ì •ì´ ë§¤ìš° ê°„ë‹¨ (ë¡œì»¬ ê°œë°œì— ìµœì )</li>
                            <li>âœ… ë©”íƒ€ë°ì´í„° í•„í„°ë§ ê¸°ëŠ¥ ê°•ë ¥</li>
                            <li>âœ… Python ìƒíƒœê³„ì™€ í˜¸í™˜</li>
                            <li>âœ… ì„ë² ë””ë“œ ëª¨ë“œ ì§€ì›</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 5: Pinecone -->
            <section id="pinecone" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">5. Pinecone</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì„¤ì • ë° ì‚¬ìš©</h3>
                    
                    <!-- Setup -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ê³„ì • ì„¤ì •</h4>
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <ol class="space-y-1 text-sm">
                                <li>1. <a href="https://www.pinecone.io" class="text-blue-600 hover:underline">pinecone.io</a>ì—ì„œ ê³„ì • ìƒì„±</li>
                                <li>2. API í‚¤ ë°œê¸‰</li>
                                <li>3. ì¸ë±ìŠ¤ ìƒì„± (ì°¨ì›: 1536, ë©”íŠ¸ë¦­: cosine)</li>
                            </ol>
                        </div>

                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('pinecone-config')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="pinecone-config"><code class="language-yaml">spring:
  ai:
    vectorstore:
      pinecone:
        api-key: ${PINECONE_API_KEY}
        environment: ${PINECONE_ENVIRONMENT}  # us-east-1-aws
        project-id: ${PINECONE_PROJECT_ID}
        index-name: spring-ai-index
        namespace: default  # ì„ íƒì‚¬í•­
        
        # ì„±ëŠ¥ ì„¤ì •
        connection-timeout: 10s
        read-timeout: 30s
        
        # ë©”íƒ€ë°ì´í„° ì„¤ì •
        metadata-fields:
          - source
          - timestamp
          - category</code></pre>
                        </div>
                    </div>

                    <!-- Service Implementation -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì„œë¹„ìŠ¤ êµ¬í˜„</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('pinecone-service')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="pinecone-service"><code class="language-java">@Service
@Slf4j
public class PineconeVectorService {
    
    private final VectorStore vectorStore;
    private final PineconeClient pineconeClient;
    
    public PineconeVectorService(
            @Qualifier("pineconeVectorStore") VectorStore vectorStore,
            PineconeClient pineconeClient) {
        this.vectorStore = vectorStore;
        this.pineconeClient = pineconeClient;
    }
    
    // ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ë¬¸ì„œ ê´€ë¦¬
    public void addDocumentsToNamespace(List<Document> documents, String namespace) {
        // ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„¤ì •
        documents.forEach(doc -> 
            doc.getMetadata().put("namespace", namespace)
        );
        
        // ë°°ì¹˜ë¡œ ì—…ë¡œë“œ (PineconeëŠ” ìµœëŒ€ 100ê°œì”©)
        List<List<Document>> batches = Lists.partition(documents, 100);
        
        batches.forEach(batch -> {
            vectorStore.add(batch);
            log.debug("Uploaded batch of {} documents to namespace: {}", 
                batch.size(), namespace);
        });
    }
    
    // ê³ ê¸‰ í•„í„°ë§ ê²€ìƒ‰
    public List<Document> advancedSearch(AdvancedSearchRequest request) {
        // Pinecone í•„í„° êµ¬ì„±
        Map<String, Object> filter = new HashMap<>();
        
        // ë©”íƒ€ë°ì´í„° í•„í„°
        if (request.getCategory() != null) {
            filter.put("category", Map.of("$eq", request.getCategory()));
        }
        
        if (request.getDateRange() != null) {
            filter.put("timestamp", Map.of(
                "$gte", request.getDateRange().getStart(),
                "$lte", request.getDateRange().getEnd()
            ));
        }
        
        // ë³µí•© í•„í„°
        if (request.getTags() != null && !request.getTags().isEmpty()) {
            filter.put("tags", Map.of("$in", request.getTags()));
        }
        
        return vectorStore.similaritySearch(
            SearchRequest.query(request.getQuery())
                .withTopK(request.getTopK())
                .withSimilarityThreshold(request.getThreshold())
                .withFilterExpression(convertToFilterExpression(filter))
        );
    }
    
    // ì¸ë±ìŠ¤ í†µê³„
    public IndexStats getIndexStats() {
        DescribeIndexResponse response = pineconeClient.describeIndex(indexName);
        
        return IndexStats.builder()
            .totalVectors(response.getDimension())
            .indexFullness(response.getIndexFullness())
            .namespaces(response.getNamespaces())
            .dimension(response.getDimension())
            .metric(response.getMetric())
            .build();
    }
    
    // ë²¡í„° ì—…ë°ì´íŠ¸
    public void updateVector(String id, Map<String, Object> metadata) {
        pineconeClient.update(
            UpdateRequest.builder()
                .id(id)
                .setMetadata(metadata)
                .namespace(namespace)
                .build()
        );
    }
    
    // ë²¡í„° ì‚­ì œ
    public void deleteVectors(List<String> ids) {
        pineconeClient.delete(
            DeleteRequest.builder()
                .ids(ids)
                .namespace(namespace)
                .build()
        );
        
        log.info("Deleted {} vectors from Pinecone", ids.size());
    }
    
    // ë¹„ìš© ëª¨ë‹ˆí„°ë§
    @Scheduled(cron = "0 0 * * * *") // ë§¤ì‹œê°„
    public void monitorUsage() {
        IndexStats stats = getIndexStats();
        
        // ì˜ˆìƒ ë¹„ìš© ê³„ì‚° (Pinecone ê°€ê²© ì •ì±…ì— ë”°ë¼)
        double estimatedMonthlyCost = calculateCost(stats);
        
        if (estimatedMonthlyCost > costThreshold) {
            alertService.sendCostAlert(
                "Pinecone usage exceeding threshold: $" + estimatedMonthlyCost
            );
        }
        
        metricsService.recordGauge("pinecone.estimated.cost", estimatedMonthlyCost);
        metricsService.recordGauge("pinecone.vectors.total", stats.getTotalVectors());
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">Pinecone ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­</h4>
                        <ul class="space-y-1 text-sm">
                            <li>âš ï¸ ë¹„ìš© ëª¨ë‹ˆí„°ë§ í•„ìˆ˜ (ë²¡í„° ìˆ˜ì™€ ì¿¼ë¦¬ì— ë”°ë¼ ê³¼ê¸ˆ)</li>
                            <li>âš ï¸ ì‚­ì œëœ ë²¡í„°ë„ ì¼ì • ê¸°ê°„ ê³¼ê¸ˆë  ìˆ˜ ìˆìŒ</li>
                            <li>âš ï¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ë°ì´í„° ë¶„ë¦¬ (ë©€í‹°í…Œë„Œì‹œ)</li>
                            <li>âš ï¸ ì¸ë±ìŠ¤ë‹¹ ìµœëŒ€ ì°¨ì› ì œí•œ í™•ì¸</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: Qdrant -->
            <section id="qdrant" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">6. Qdrant</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì„¤ì¹˜ ë° ì„¤ì •</h3>
                    
                    <!-- Docker Setup -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Docker ì„¤ì¹˜</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('qdrant-docker')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="qdrant-docker"><code class="language-bash"># Qdrant ì‹¤í–‰
docker run -p 6333:6333 \
  -v $(pwd)/qdrant_storage:/qdrant/storage \
  qdrant/qdrant

# Docker Compose
cat > docker-compose.yml << EOF
version: '3.8'
services:
  qdrant:
    image: qdrant/qdrant
    ports:
      - "6333:6333"
      - "6334:6334"  # gRPC port
    volumes:
      - ./qdrant_storage:/qdrant/storage
    environment:
      - QDRANT__SERVICE__GRPC_PORT=6334
EOF</code></pre>
                        </div>
                    </div>

                    <!-- Configuration -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">Spring ì„¤ì •</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('qdrant-config')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="qdrant-config"><code class="language-yaml">spring:
  ai:
    vectorstore:
      qdrant:
        host: localhost
        port: 6334  # gRPC port for better performance
        collection-name: spring-ai-collection
        use-tls: false
        
        # ì»¬ë ‰ì…˜ ì„¤ì •
        vector-params:
          size: 1536
          distance: COSINE  # COSINE, EUCLID, DOT
          
        # ì„±ëŠ¥ ì„¤ì •
        batch-size: 100
        timeout: 30s
        
        # ì˜µí‹°ë§ˆì´ì € ì„¤ì •
        optimizer-config:
          indexing-threshold: 20000
          memmap-threshold: 100000</code></pre>
                        </div>
                    </div>

                    <!-- Service Implementation -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì„œë¹„ìŠ¤ êµ¬í˜„</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('qdrant-service')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="qdrant-service"><code class="language-java">@Service
@Slf4j
public class QdrantVectorService {
    
    private final VectorStore vectorStore;
    private final QdrantClient qdrantClient;
    
    public QdrantVectorService(
            @Qualifier("qdrantVectorStore") VectorStore vectorStore,
            QdrantClient qdrantClient) {
        this.vectorStore = vectorStore;
        this.qdrantClient = qdrantClient;
    }
    
    // ì»¬ë ‰ì…˜ ìƒì„± (ê³ ê¸‰ ì„¤ì •)
    public void createCollection(String name, CollectionConfig config) {
        CreateCollection request = CreateCollection.newBuilder()
            .setCollectionName(name)
            .setVectorsConfig(VectorsConfig.newBuilder()
                .setParams(VectorParams.newBuilder()
                    .setSize(config.getDimension())
                    .setDistance(config.getDistance())
                    .build())
                .build())
            .setOptimizersConfig(OptimizersConfig.newBuilder()
                .setDefaultSegmentNumber(2)
                .setIndexingThreshold(20000)
                .build())
            .setWalConfig(WalConfig.newBuilder()
                .setWalCapacityMb(32)
                .setWalSegments(8)
                .build())
            .build();
        
        qdrantClient.createCollection(request);
        log.info("Created Qdrant collection: {} with config: {}", name, config);
    }
    
    // í˜ì´ë¡œë“œ í•„í„°ë§ ê²€ìƒ‰
    public List<Document> searchWithPayloadFilter(SearchRequest request) {
        // Qdrantì˜ ê°•ë ¥í•œ í•„í„°ë§ ê¸°ëŠ¥ í™œìš©
        Filter filter = buildQdrantFilter(request.getFilters());
        
        SearchPoints searchRequest = SearchPoints.newBuilder()
            .setCollectionName(collectionName)
            .setVector(request.getEmbedding())
            .setLimit(request.getLimit())
            .setFilter(filter)
            .setWithPayload(WithPayloadSelector.newBuilder()
                .setEnable(true)
                .build())
            .setScoreThreshold(request.getThreshold())
            .build();
        
        List<ScoredPoint> results = qdrantClient.search(searchRequest)
            .get();
        
        return results.stream()
            .map(this::convertToDocument)
            .collect(Collectors.toList());
    }
    
    // ë³µì¡í•œ í•„í„° êµ¬ì„±
    private Filter buildQdrantFilter(Map<String, Object> filters) {
        List<Condition> conditions = new ArrayList<>();
        
        filters.forEach((key, value) -> {
            if (value instanceof String) {
                conditions.add(Condition.newBuilder()
                    .setField(FieldCondition.newBuilder()
                        .setKey(key)
                        .setMatch(Match.newBuilder()
                            .setKeyword(value.toString())
                            .build())
                        .build())
                    .build());
            } else if (value instanceof Number) {
                conditions.add(Condition.newBuilder()
                    .setField(FieldCondition.newBuilder()
                        .setKey(key)
                        .setRange(Range.newBuilder()
                            .setGte(((Number) value).doubleValue())
                            .build())
                        .build())
                    .build());
            } else if (value instanceof List) {
                conditions.add(Condition.newBuilder()
                    .setField(FieldCondition.newBuilder()
                        .setKey(key)
                        .setMatch(Match.newBuilder()
                            .setAny((List<String>) value)
                            .build())
                        .build())
                    .build());
            }
        });
        
        return Filter.newBuilder()
            .addAllMust(conditions)
            .build();
    }
    
    // ë²¡í„° ì—…ë°ì´íŠ¸ (í˜ì´ë¡œë“œë§Œ)
    public void updatePayload(String pointId, Map<String, Object> payload) {
        SetPayload setPayload = SetPayload.newBuilder()
            .setCollectionName(collectionName)
            .setPayload(buildPayload(payload))
            .addPoints(PointsSelector.newBuilder()
                .addIds(PointId.newBuilder()
                    .setUuid(pointId)
                    .build())
                .build())
            .build();
        
        qdrantClient.setPayload(setPayload).get();
    }
    
    // ìŠ¤ëƒ…ìƒ· ìƒì„±
    public String createSnapshot() {
        CreateSnapshot request = CreateSnapshot.newBuilder()
            .setCollectionName(collectionName)
            .build();
        
        CreateSnapshotResponse response = qdrantClient.createSnapshot(request).get();
        String snapshotName = response.getSnapshotDescription().getName();
        
        log.info("Created Qdrant snapshot: {}", snapshotName);
        return snapshotName;
    }
    
    // ì»¬ë ‰ì…˜ ìµœì í™”
    @Scheduled(cron = "0 0 3 * * SUN") // ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 3ì‹œ
    public void optimizeCollection() {
        UpdateCollection request = UpdateCollection.newBuilder()
            .setCollectionName(collectionName)
            .setOptimizersConfig(OptimizersConfig.newBuilder()
                .setIndexingThreshold(50000)
                .build())
            .build();
        
        qdrantClient.updateCollection(request);
        log.info("Optimized Qdrant collection: {}", collectionName);
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="bg-purple-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">Qdrant íŠ¹ì§•</h4>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸš€ ë§¤ìš° ë¹ ë¥¸ ê²€ìƒ‰ ì†ë„</li>
                            <li>ğŸ” ê°•ë ¥í•œ í•„í„°ë§ ê¸°ëŠ¥</li>
                            <li>ğŸ’¾ íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ì‚¬ìš©</li>
                            <li>ğŸ”„ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì§€ì›</li>
                            <li>ğŸ“¸ ìŠ¤ëƒ…ìƒ·/ë°±ì—… ê¸°ëŠ¥</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 7: Optimization -->
            <section id="optimization" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">7. ì„±ëŠ¥ ìµœì í™”</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ê³µí†µ ìµœì í™” ì „ëµ</h3>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2">ì¸ë±ì‹± ìµœì í™”</h4>
                            <ul class="space-y-1 text-sm">
                                <li>â€¢ ì ì ˆí•œ ì¸ë±ìŠ¤ íƒ€ì… ì„ íƒ (HNSW vs IVF)</li>
                                <li>â€¢ ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° íŠœë‹</li>
                                <li>â€¢ ì •ê¸°ì ì¸ ì¸ë±ìŠ¤ ì¬êµ¬ì¶•</li>
                                <li>â€¢ ìƒ¤ë”©/íŒŒí‹°ì…”ë‹ ì „ëµ</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-2">ì¿¼ë¦¬ ìµœì í™”</h4>
                            <ul class="space-y-1 text-sm">
                                <li>â€¢ ë°°ì¹˜ ì¿¼ë¦¬ í™œìš©</li>
                                <li>â€¢ í•„í„° ì¡°ê±´ ìµœì í™”</li>
                                <li>â€¢ ìºì‹± ì „ëµ êµ¬í˜„</li>
                                <li>â€¢ ë¹„ë™ê¸° ì²˜ë¦¬</li>
                            </ul>
                        </div>
                    </div>

                    <div class="mt-6">
                        <h4 class="font-semibold mb-3">ë²¤ì¹˜ë§ˆí¬ ì½”ë“œ</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('benchmark-code')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="benchmark-code"><code class="language-java">@Component
@Slf4j
public class VectorStoreBenchmark {
    
    private final Map<String, VectorStore> vectorStores;
    
    public BenchmarkResult runBenchmark(int numDocuments, int numQueries) {
        Map<String, PerformanceMetrics> results = new HashMap<>();
        
        vectorStores.forEach((name, store) -> {
            log.info("Running benchmark for: {}", name);
            
            // 1. ì‚½ì… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
            long insertTime = measureInsertTime(store, numDocuments);
            
            // 2. ê²€ìƒ‰ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
            SearchPerformance searchPerf = measureSearchPerformance(store, numQueries);
            
            // 3. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
            long memoryUsage = measureMemoryUsage(store);
            
            results.put(name, PerformanceMetrics.builder()
                .insertTimeMs(insertTime)
                .avgSearchTimeMs(searchPerf.getAvgTime())
                .p95SearchTimeMs(searchPerf.getP95Time())
                .memoryUsageMb(memoryUsage)
                .build());
        });
        
        return new BenchmarkResult(results);
    }
    
    private long measureInsertTime(VectorStore store, int numDocuments) {
        List<Document> documents = generateTestDocuments(numDocuments);
        
        long startTime = System.currentTimeMillis();
        
        // ë°°ì¹˜ í¬ê¸°ë³„ í…ŒìŠ¤íŠ¸
        List<List<Document>> batches = Lists.partition(documents, 100);
        batches.parallelStream().forEach(store::add);
        
        return System.currentTimeMillis() - startTime;
    }
    
    private SearchPerformance measureSearchPerformance(VectorStore store, int numQueries) {
        List<String> queries = generateTestQueries(numQueries);
        List<Long> searchTimes = new ArrayList<>();
        
        queries.forEach(query -> {
            long start = System.nanoTime();
            store.similaritySearch(SearchRequest.query(query).withTopK(10));
            searchTimes.add(System.nanoTime() - start);
        });
        
        return calculatePerformanceStats(searchTimes);
    }
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 8: Migration -->
            <section id="migration" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">8. ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="text-lg font-semibold mb-3">ë²¡í„° ìŠ¤í† ì–´ ê°„ ë§ˆì´ê·¸ë ˆì´ì…˜</h3>
                    
                    <div class="code-block p-4 relative mb-6">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('migration-service')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="migration-service"><code class="language-java">@Service
@Slf4j
public class VectorStoreMigrationService {
    
    public MigrationResult migrate(
            VectorStore source, 
            VectorStore target,
            MigrationOptions options) {
        
        log.info("Starting migration from {} to {}", 
            source.getClass().getSimpleName(),
            target.getClass().getSimpleName());
        
        long totalDocuments = 0;
        long migratedDocuments = 0;
        
        try {
            // 1. ì†ŒìŠ¤ì—ì„œ ëª¨ë“  ë¬¸ì„œ ì¶”ì¶œ
            List<Document> allDocuments = extractAllDocuments(source, options);
            totalDocuments = allDocuments.size();
            
            // 2. ë°°ì¹˜ë¡œ íƒ€ê²Ÿì— ì‚½ì…
            List<List<Document>> batches = Lists.partition(
                allDocuments, 
                options.getBatchSize()
            );
            
            for (List<Document> batch : batches) {
                target.add(batch);
                migratedDocuments += batch.size();
                
                log.info("Migrated {}/{} documents", 
                    migratedDocuments, totalDocuments);
                
                // ì˜µì…˜: ì§„í–‰ë¥  ì½œë°±
                if (options.getProgressCallback() != null) {
                    options.getProgressCallback().accept(
                        (double) migratedDocuments / totalDocuments
                    );
                }
            }
            
            // 3. ê²€ì¦
            if (options.isValidateAfterMigration()) {
                boolean valid = validateMigration(source, target);
                if (!valid) {
                    throw new MigrationException("Validation failed");
                }
            }
            
            return MigrationResult.success(totalDocuments, migratedDocuments);
            
        } catch (Exception e) {
            log.error("Migration failed", e);
            return MigrationResult.failure(totalDocuments, migratedDocuments, e);
        }
    }
    
    private List<Document> extractAllDocuments(
            VectorStore source, 
            MigrationOptions options) {
        
        // êµ¬í˜„ì€ ë²¡í„° ìŠ¤í† ì–´ íƒ€ì…ì— ë”°ë¼ ë‹¤ë¦„
        if (source instanceof PGVectorStore) {
            return extractFromPGVector((PGVectorStore) source);
        } else if (source instanceof ChromaVectorStore) {
            return extractFromChroma((ChromaVectorStore) source);
        }
        // ... ë‹¤ë¥¸ ë²¡í„° ìŠ¤í† ì–´ë“¤
        
        throw new UnsupportedOperationException(
            "Extraction not supported for: " + source.getClass()
        );
    }
}</code></pre>
                    </div>

                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸</h4>
                        <ul class="space-y-1 text-sm">
                            <li>âœ… ì†ŒìŠ¤ ë°ì´í„° ë°±ì—…</li>
                            <li>âœ… íƒ€ê²Ÿ ìŠ¤í† ì–´ ìš©ëŸ‰ í™•ì¸</li>
                            <li>âœ… ë©”íƒ€ë°ì´í„° í˜¸í™˜ì„± ê²€ì¦</li>
                            <li>âœ… ì„ë² ë”© ì°¨ì› ì¼ì¹˜ í™•ì¸</li>
                            <li>âœ… ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš</li>
                            <li>âœ… ë¡¤ë°± ê³„íš ìˆ˜ë¦½</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Best Practices -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ğŸ¯ Best Practices</h2>
                
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">ë²¡í„° ìŠ¤í† ì–´ ì„ íƒ ê°€ì´ë“œ</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-semibold">ì†Œê·œëª¨ í”„ë¡œì íŠ¸ (< 100K ë²¡í„°)</h4>
                            <p class="text-sm">â†’ Chroma ë˜ëŠ” PGVector</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold">ì¤‘ê·œëª¨ í”„ë¡œì íŠ¸ (100K - 10M ë²¡í„°)</h4>
                            <p class="text-sm">â†’ Qdrant ë˜ëŠ” Weaviate</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold">ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ (> 10M ë²¡í„°)</h4>
                            <p class="text-sm">â†’ Pinecone ë˜ëŠ” Qdrant Cloud</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold">ì—”í„°í”„ë¼ì´ì¦ˆ</h4>
                            <p class="text-sm">â†’ Pinecone ë˜ëŠ” ìì²´ ê´€ë¦¬ Qdrant/Weaviate</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Next Steps -->
            <section class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-xl font-semibold mb-4">ë‹¤ìŒ ë‹¨ê³„</h2>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <a href="rag.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-blue-600 mb-2">RAG ì‹œìŠ¤í…œ êµ¬ì¶•</h3>
                        <p class="text-sm text-gray-600">ë²¡í„° ìŠ¤í† ì–´ë¥¼ í™œìš©í•œ RAG êµ¬í˜„</p>
                    </a>
                    
                    <a href="monitoring.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-green-600 mb-2">ëª¨ë‹ˆí„°ë§</h3>
                        <p class="text-sm text-gray-600">ë²¡í„° ìŠ¤í† ì–´ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§</p>
                    </a>
                    
                    <a href="patterns.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-purple-600 mb-2">ê³ ê¸‰ íŒ¨í„´</h3>
                        <p class="text-sm text-gray-600">ë²¡í„° ìŠ¤í† ì–´ í™œìš© íŒ¨í„´</p>
                    </a>
                </div>
            </section>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        function copyCode(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }
    </script>
</body>
</html>