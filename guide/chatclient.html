<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatClient ê°€ì´ë“œ - Spring AI</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .code-block { background: #2d3748; border-radius: 8px; }
        .copy-button { transition: all 0.2s ease; }
        .copy-button:hover { background-color: #4a5568; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <a href="../index.html" class="flex items-center text-xl font-bold text-gray-800">
                        <i class="fab fa-spring text-green-600 mr-2"></i>
                        Spring AI Hub
                    </a>
                    <span class="mx-3 text-gray-400">/</span>
                    <span class="text-gray-600">ChatClient ê°€ì´ë“œ</span>
                </div>
                <a href="../index.html" class="text-blue-600 hover:text-blue-800">
                    <i class="fas fa-home"></i> í™ˆìœ¼ë¡œ
                </a>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl font-bold mb-4">ğŸ’¬ ChatClient ê°€ì´ë“œ</h1>
            <p class="text-gray-600 mb-8">Spring AI ChatClient API ì™„ì „ ê°€ì´ë“œ - ê¸°ë³¸ ì‚¬ìš©ë²•ë¶€í„° ê³ ê¸‰ íŒ¨í„´ê¹Œì§€</p>

            <!-- Introduction -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ê°œìš”</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <p class="mb-4">
                        <strong>ChatClient</strong>ëŠ” Spring AIì˜ í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ë¡œ, AI ëª¨ë¸ê³¼ì˜ ëŒ€í™”ë¥¼ ìœ„í•œ 
                        ìœ ì—°í•˜ê³  ê°•ë ¥í•œ APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ ê´€ë¦¬, ì‘ë‹µ ì²˜ë¦¬, ìŠ¤íŠ¸ë¦¬ë°, í•¨ìˆ˜ í˜¸ì¶œ ë“± 
                        ëª¨ë“  AI ìƒí˜¸ì‘ìš©ì„ ê°„ë‹¨í•œ APIë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    
                    <div class="bg-blue-50 p-4 rounded-lg mb-4">
                        <h3 class="font-semibold mb-2">ì£¼ìš” íŠ¹ì§•:</h3>
                        <ul class="space-y-1">
                            <li>âœ… í”Œë£¨ì–¸íŠ¸ APIë¡œ ì§ê´€ì ì¸ ì‚¬ìš©ë²•</li>
                            <li>âœ… ë‹¤ì–‘í•œ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì§€ì›</li>
                            <li>âœ… ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì²˜ë¦¬</li>
                            <li>âœ… í•¨ìˆ˜ í˜¸ì¶œ (Tool Calling) ì§€ì›</li>
                            <li>âœ… Advisor íŒ¨í„´ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥</li>
                            <li>âœ… ë‹¤ì–‘í•œ ì‘ë‹µ í˜•íƒœ (String, Entity, Stream)</li>
                        </ul>
                    </div>

                    <div class="bg-gray-100 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">ChatClient êµ¬ì¡°:</h3>
                        <pre class="text-sm font-mono">
ChatClient
    â†“
PromptSpec (í”„ë¡¬í”„íŠ¸ êµ¬ì„±)
    â†“
CallSpec (í˜¸ì¶œ ë°©ì‹ ì„¤ì •)
    â†“
ResponseSpec (ì‘ë‹µ ì²˜ë¦¬)
                        </pre>
                    </div>
                </div>
            </section>

            <!-- Basic Usage -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ê¸°ë³¸ ì‚¬ìš©ë²•</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ChatClient ì„¤ì • ë° ê¸°ë³¸ í˜¸ì¶œ</h3>
                    
                    <div class="code-block p-4 relative mb-4">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('chatclient-basic')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="chatclient-basic"><code class="language-java">@Configuration
public class ChatClientConfig {
    
    @Bean
    public ChatClient chatClient(ChatModel chatModel) {
        return ChatClient.builder(chatModel)
            .defaultSystem("ë‹¹ì‹ ì€ ë„ì›€ì´ ë˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.")
            .build();
    }
}

@Service
public class ChatService {
    
    private final ChatClient chatClient;
    
    public ChatService(ChatClient chatClient) {
        this.chatClient = chatClient;
    }
    
    // ê¸°ë³¸ í…ìŠ¤íŠ¸ ì‘ë‹µ
    public String simpleChat(String userMessage) {
        return chatClient.prompt()
            .user(userMessage)
            .call()
            .content();
    }
    
    // ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì™€ í•¨ê»˜
    public String chatWithSystem(String userMessage) {
        return chatClient.prompt()
            .system("ë‹¹ì‹ ì€ ì „ë¬¸ í”„ë¡œê·¸ë˜ë° íŠœí„°ì…ë‹ˆë‹¤.")
            .user(userMessage)
            .call()
            .content();
    }
    
    // ëŒ€í™” íˆìŠ¤í† ë¦¬ í¬í•¨
    public String chatWithHistory(List&lt;Message&gt; history, String userMessage) {
        PromptSpec promptSpec = chatClient.prompt()
            .messages(history)
            .user(userMessage);
        
        return promptSpec.call().content();
    }
}</code></pre>
                    </div>
                </div>

                <!-- Prompt Templates -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('prompt-templates')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="prompt-templates"><code class="language-java">@Service
public class TemplatedChatService {
    
    private final ChatClient chatClient;
    
    // íŒŒë¼ë¯¸í„°í™”ëœ í”„ë¡¬í”„íŠ¸
    public String analyzeCode(String code, String language) {
        return chatClient.prompt()
            .system("ë‹¹ì‹ ì€ ì½”ë“œ ë¦¬ë·° ì „ë¬¸ê°€ì…ë‹ˆë‹¤.")
            .user(u -&gt; u.text("""
                ë‹¤ìŒ {language} ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ê°œì„ ì ì„ ì œì•ˆí•´ì£¼ì„¸ìš”:
                
                ```{language}
                {code}
                ```
                
                ë¶„ì„ ê²°ê³¼:
                1. ì½”ë“œ í’ˆì§ˆ í‰ê°€
                2. ì ì¬ì  ë¬¸ì œì 
                3. ê°œì„  ì œì•ˆ
                4. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
                """)
                .param("code", code)
                .param("language", language))
            .call()
            .content();
    }
    
    // ì™¸ë¶€ í…œí”Œë¦¿ íŒŒì¼ ì‚¬ìš©
    public String generateEmail(EmailRequest request) {
        return chatClient.prompt()
            .user(u -&gt; u.text(loadTemplate("email-template.st"))
                .param("recipient", request.getRecipient())
                .param("subject", request.getSubject())
                .param("content", request.getContent())
                .param("tone", request.getTone()))
            .call()
            .content();
    }
    
    // ë³µí•© í”„ë¡¬í”„íŠ¸
    public String createTutorial(TutorialRequest request) {
        return chatClient.prompt()
            .system("""
                ë‹¹ì‹ ì€ ê¸°ìˆ  ë¬¸ì„œ ì‘ì„± ì „ë¬¸ê°€ì…ë‹ˆë‹¤. 
                ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” íŠœí† ë¦¬ì–¼ì„ ì‘ì„±í•´ì£¼ì„¸ìš”:
                - ëŒ€ìƒ: {audience}
                - ë‚œì´ë„: {level}
                - í˜•ì‹: {format}
                """)
            .user(u -&gt; u.text("""
                ì£¼ì œ: {topic}
                
                í¬í•¨í•  ë‚´ìš©:
                {content_points}
                
                ì˜ˆì œ ì½”ë“œê°€ í•„ìš”í•œ ë¶€ë¶„:
                {code_examples}
                
                ì°¸ê³  ìë£Œ:
                {references}
                """)
                .param("topic", request.getTopic())
                .param("content_points", String.join("\n- ", request.getContentPoints()))
                .param("code_examples", String.join("\n- ", request.getCodeExamples()))
                .param("references", String.join("\n- ", request.getReferences()))
                .param("audience", request.getAudience())
                .param("level", request.getLevel())
                .param("format", request.getFormat()))
            .call()
            .content();
    }
    
    private String loadTemplate(String templateName) {
        try {
            Resource resource = new ClassPathResource("templates/" + templateName);
            return Files.readString(resource.getFile().toPath());
        } catch (IOException e) {
            throw new RuntimeException("Failed to load template: " + templateName, e);
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Streaming Responses -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì‹¤ì‹œê°„ ì‘ë‹µ ì²˜ë¦¬</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('streaming-responses')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="streaming-responses"><code class="language-java">@RestController
@RequestMapping("/api/chat")
public class StreamingChatController {
    
    private final ChatClient chatClient;
    
    // Server-Sent Eventsë¡œ ìŠ¤íŠ¸ë¦¬ë°
    @PostMapping(value = "/stream", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux&lt;ServerSentEvent&lt;String&gt;&gt; streamChat(@RequestBody ChatRequest request) {
        return chatClient.prompt()
            .user(request.getMessage())
            .stream()
            .content()
            .map(chunk -&gt; ServerSentEvent.&lt;String&gt;builder()
                .data(chunk)
                .event("message")
                .build())
            .concatWith(Mono.just(ServerSentEvent.&lt;String&gt;builder()
                .event("complete")
                .data("[DONE]")
                .build()));
    }
    
    // WebSocketì„ í†µí•œ ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°
    @MessageMapping("/chat")
    @SendTo("/topic/responses")
    public Flux&lt;ChatChunk&gt; handleWebSocketChat(ChatMessage message) {
        return chatClient.prompt()
            .user(message.getContent())
            .stream()
            .content()
            .map(content -&gt; ChatChunk.builder()
                .sessionId(message.getSessionId())
                .content(content)
                .timestamp(Instant.now())
                .build());
    }
    
    // ì¡°ê±´ë¶€ ìŠ¤íŠ¸ë¦¬ë°
    @PostMapping("/adaptive")
    public ResponseEntity&lt;?&gt; adaptiveChat(@RequestBody ChatRequest request) {
        if (request.isStreamingPreferred() && isLongFormResponse(request)) {
            // ê¸´ ì‘ë‹µì€ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ
            Flux&lt;String&gt; stream = chatClient.prompt()
                .user(request.getMessage())
                .stream()
                .content();
            
            return ResponseEntity.ok()
                .contentType(MediaType.TEXT_EVENT_STREAM)
                .body(stream);
        } else {
            // ì§§ì€ ì‘ë‹µì€ ì¼ë°˜ ì‘ë‹µìœ¼ë¡œ
            String response = chatClient.prompt()
                .user(request.getMessage())
                .call()
                .content();
            
            return ResponseEntity.ok(new ChatResponse(response));
        }
    }
    
    private boolean isLongFormResponse(ChatRequest request) {
        // ì‘ë‹µ ê¸¸ì´ ì˜ˆì¸¡ ë¡œì§
        return request.getMessage().contains("ì„¤ëª…") || 
               request.getMessage().contains("ìì„¸íˆ") ||
               request.getMessage().contains("íŠœí† ë¦¬ì–¼");
    }
}

@Service
public class StreamingProcessorService {
    
    private final ChatClient chatClient;
    
    // ìŠ¤íŠ¸ë¦¼ ë³€í™˜ ë° ì²˜ë¦¬
    public Flux&lt;ProcessedChunk&gt; processStreamWithTransformation(String userMessage) {
        return chatClient.prompt()
            .user(userMessage)
            .stream()
            .content()
            .buffer(Duration.ofMillis(100)) // 100msë§ˆë‹¤ ì²­í¬ ìˆ˜ì§‘
            .map(this::combineChunks)
            .filter(chunk -&gt; !chunk.isEmpty())
            .map(this::processChunk)
            .doOnNext(this::logChunk)
            .onErrorResume(this::handleStreamError);
    }
    
    // ìŠ¤íŠ¸ë¦¼ ìƒíƒœ ê´€ë¦¬
    public Flux&lt;ChatState&gt; chatWithStateTracking(String sessionId, String message) {
        AtomicInteger chunkCount = new AtomicInteger(0);
        AtomicLong totalTokens = new AtomicLong(0);
        
        return chatClient.prompt()
            .user(message)
            .stream()
            .chatResponse()
            .map(response -&gt; {
                int chunks = chunkCount.incrementAndGet();
                long tokens = totalTokens.addAndGet(
                    response.getMetadata().getUsage().getTotalTokens()
                );
                
                return ChatState.builder()
                    .sessionId(sessionId)
                    .chunkCount(chunks)
                    .totalTokens(tokens)
                    .content(response.getResult().getOutput().getContent())
                    .isComplete(false)
                    .build();
            })
            .concatWith(Mono.just(ChatState.builder()
                .sessionId(sessionId)
                .chunkCount(chunkCount.get())
                .totalTokens(totalTokens.get())
                .isComplete(true)
                .build()));
    }
    
    private String combineChunks(List&lt;String&gt; chunks) {
        return String.join("", chunks);
    }
    
    private ProcessedChunk processChunk(String content) {
        return ProcessedChunk.builder()
            .content(content)
            .wordCount(content.split("\\s+").length)
            .timestamp(Instant.now())
            .build();
    }
    
    private void logChunk(ProcessedChunk chunk) {
        log.debug("Processed chunk: {} words at {}", 
                 chunk.getWordCount(), chunk.getTimestamp());
    }
    
    private Flux&lt;ProcessedChunk&gt; handleStreamError(Throwable error) {
        log.error("Stream processing error", error);
        return Flux.just(ProcessedChunk.error("ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."));
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Entity Mapping -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">êµ¬ì¡°í™”ëœ ì‘ë‹µ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">Entity ë§¤í•‘</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('entity-mapping')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="entity-mapping"><code class="language-java">// DTO í´ë˜ìŠ¤ ì •ì˜
@Data
@Builder
public class CodeAnalysisResult {
    private String language;
    private int complexityScore;
    private List&lt;Issue&gt; issues;
    private List&lt;Suggestion&gt; suggestions;
    private SecurityAssessment security;
    private PerformanceMetrics performance;
}

@Data
public class Issue {
    private String type; // "error", "warning", "info"
    private String message;
    private int lineNumber;
    private String severity;
}

@Data
public class Suggestion {
    private String category;
    private String description;
    private String improvedCode;
    private int priority;
}

@Service
public class StructuredResponseService {
    
    private final ChatClient chatClient;
    
    // ë‹¨ì¼ ê°ì²´ ì‘ë‹µ
    public CodeAnalysisResult analyzeCodeStructured(String code, String language) {
        return chatClient.prompt()
            .system("""
                ë‹¹ì‹ ì€ ì½”ë“œ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. 
                ì œê³µëœ ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ê²°ê³¼ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ì„¸ìš”.
                """)
            .user(u -&gt; u.text("""
                ë‹¤ìŒ {language} ì½”ë“œë¥¼ ë¶„ì„í•˜ì„¸ìš”:
                
                ```{language}
                {code}
                ```
                
                ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”:
                {
                  "language": "ì–¸ì–´ëª…",
                  "complexityScore": 1-10,
                  "issues": [
                    {
                      "type": "error|warning|info",
                      "message": "ë¬¸ì œ ì„¤ëª…",
                      "lineNumber": í–‰ë²ˆí˜¸,
                      "severity": "high|medium|low"
                    }
                  ],
                  "suggestions": [
                    {
                      "category": "ì¹´í…Œê³ ë¦¬",
                      "description": "ì œì•ˆ ë‚´ìš©",
                      "improvedCode": "ê°œì„ ëœ ì½”ë“œ",
                      "priority": 1-5
                    }
                  ],
                  "security": {
                    "hasVulnerabilities": true/false,
                    "vulnerabilities": ["ì·¨ì•½ì  ëª©ë¡"],
                    "securityScore": 1-10
                  },
                  "performance": {
                    "score": 1-10,
                    "bottlenecks": ["ì„±ëŠ¥ ë³‘ëª©ì "],
                    "optimizations": ["ìµœì í™” ì œì•ˆ"]
                  }
                }
                """)
                .param("code", code)
                .param("language", language))
            .call()
            .entity(CodeAnalysisResult.class);
    }
    
    // ë¦¬ìŠ¤íŠ¸ ì‘ë‹µ
    public List&lt;TaskItem&gt; generateTaskList(String projectDescription) {
        return chatClient.prompt()
            .system("í”„ë¡œì íŠ¸ ê´€ë¦¬ ì „ë¬¸ê°€ë¡œì„œ ì‘ì—… ëª©ë¡ì„ ìƒì„±í•˜ì„¸ìš”.")
            .user(u -&gt; u.text("""
                í”„ë¡œì íŠ¸ ì„¤ëª…: {description}
                
                ì´ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ ìƒì„¸í•œ ì‘ì—… ëª©ë¡ì„ JSON ë°°ì—´ë¡œ ìƒì„±í•˜ì„¸ìš”:
                [
                  {
                    "title": "ì‘ì—… ì œëª©",
                    "description": "ì‘ì—… ì„¤ëª…",
                    "priority": "high|medium|low",
                    "estimatedHours": ì˜ˆìƒì‹œê°„,
                    "dependencies": ["ì˜ì¡´ì„± ì‘ì—…ë“¤"],
                    "tags": ["íƒœê·¸ë“¤"],
                    "assignee": "ë‹´ë‹¹ì ì—­í• "
                  }
                ]
                """)
                .param("description", projectDescription))
            .call()
            .entity(new ParameterizedTypeReference&lt;List&lt;TaskItem&gt;&gt;() {});
    }
    
    // ë³µí•© ì‘ë‹µ íƒ€ì…
    public ProjectPlan createProjectPlan(ProjectRequest request) {
        return chatClient.prompt()
            .system("í”„ë¡œì íŠ¸ ê³„íš ìˆ˜ë¦½ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.")
            .user(u -&gt; u.text("""
                í”„ë¡œì íŠ¸ ì •ë³´:
                - ì´ë¦„: {name}
                - ëª©í‘œ: {objectives}
                - ì˜ˆì‚°: {budget}
                - ê¸°ê°„: {duration}
                - íŒ€ í¬ê¸°: {teamSize}
                
                ìƒì„¸í•œ í”„ë¡œì íŠ¸ ê³„íšì„ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:
                {
                  "projectInfo": {
                    "name": "í”„ë¡œì íŠ¸ëª…",
                    "description": "í”„ë¡œì íŠ¸ ì„¤ëª…",
                    "objectives": ["ëª©í‘œ1", "ëª©í‘œ2"],
                    "timeline": {
                      "startDate": "YYYY-MM-DD",
                      "endDate": "YYYY-MM-DD",
                      "milestones": [
                        {
                          "name": "ë§ˆì¼ìŠ¤í†¤ëª…",
                          "date": "YYYY-MM-DD",
                          "deliverables": ["ì‚°ì¶œë¬¼ë“¤"]
                        }
                      ]
                    }
                  },
                  "phases": [
                    {
                      "name": "ë‹¨ê³„ëª…",
                      "duration": "ê¸°ê°„",
                      "tasks": ["ì‘ì—…ë“¤"],
                      "resources": ["í•„ìš” ìì›ë“¤"]
                    }
                  ],
                  "risks": [
                    {
                      "description": "ë¦¬ìŠ¤í¬ ì„¤ëª…",
                      "probability": "high|medium|low",
                      "impact": "high|medium|low",
                      "mitigation": "ëŒ€ì‘ë°©ì•ˆ"
                    }
                  ],
                  "budget": {
                    "totalBudget": ì´ì˜ˆì‚°,
                    "breakdown": {
                      "development": ê°œë°œë¹„ìš©,
                      "testing": í…ŒìŠ¤íŠ¸ë¹„ìš©,
                      "deployment": ë°°í¬ë¹„ìš©,
                      "maintenance": ìœ ì§€ë³´ìˆ˜ë¹„ìš©
                    }
                  }
                }
                """)
                .param("name", request.getName())
                .param("objectives", String.join(", ", request.getObjectives()))
                .param("budget", request.getBudget())
                .param("duration", request.getDuration())
                .param("teamSize", request.getTeamSize()))
            .call()
            .entity(ProjectPlan.class);
    }
    
    // ìŠ¤íŠ¸ë¦¬ë° + êµ¬ì¡°í™”ëœ ì‘ë‹µ
    public Flux&lt;PartialAnalysis&gt; analyzeCodeStreamStructured(String code) {
        return chatClient.prompt()
            .system("ì½”ë“œë¥¼ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•˜ê³  ê° ë‹¨ê³„ë§ˆë‹¤ JSON ê²°ê³¼ë¥¼ ì œê³µí•˜ì„¸ìš”.")
            .user(u -&gt; u.text("""
                ì½”ë“œ: {code}
                
                ë‹¤ìŒ ìˆœì„œë¡œ ë¶„ì„í•˜ê³  ê° ë‹¨ê³„ë§ˆë‹¤ JSONìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”:
                1. ë¬¸ë²• ê²€ì‚¬
                2. ë³µì¡ë„ ë¶„ì„  
                3. ë³´ì•ˆ ê²€ì‚¬
                4. ì„±ëŠ¥ ë¶„ì„
                5. ìµœì¢… ê¶Œì¥ì‚¬í•­
                """)
                .param("code", code))
            .stream()
            .content()
            .buffer(Duration.ofSeconds(1))
            .map(chunks -&gt; String.join("", chunks))
            .filter(this::isValidJson)
            .map(json -&gt; parsePartialAnalysis(json))
            .onErrorResume(error -&gt; {
                log.warn("JSON parsing error: {}", error.getMessage());
                return Flux.empty();
            });
    }
    
    private boolean isValidJson(String content) {
        try {
            objectMapper.readTree(content);
            return true;
        } catch (Exception e) {
            return false;
        }
    }
    
    private PartialAnalysis parsePartialAnalysis(String json) {
        try {
            return objectMapper.readValue(json, PartialAnalysis.class);
        } catch (Exception e) {
            return PartialAnalysis.error("JSON íŒŒì‹± ì˜¤ë¥˜: " + e.getMessage());
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Advanced Patterns -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ê³ ê¸‰ íŒ¨í„´</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì¡°ê±´ë¶€ í˜¸ì¶œ ë° ì¬ì‹œë„</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('advanced-patterns')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="advanced-patterns"><code class="language-java">@Service
public class RobustChatService {
    
    private final ChatClient chatClient;
    private final RetryTemplate retryTemplate;
    
    public RobustChatService(ChatClient chatClient) {
        this.chatClient = chatClient;
        this.retryTemplate = RetryTemplate.builder()
            .maxAttempts(3)
            .exponentialBackoff(1000, 2, 10000)
            .retryOn(ChatException.class)
            .build();
    }
    
    // ì¬ì‹œë„ ë¡œì§
    public String chatWithRetry(String userMessage) {
        return retryTemplate.execute(context -&gt; {
            log.info("Chat attempt {}", context.getRetryCount() + 1);
            
            return chatClient.prompt()
                .user(userMessage)
                .call()
                .content();
        });
    }
    
    // í´ë°± ì²˜ë¦¬
    public String chatWithFallback(String userMessage) {
        try {
            return chatClient.prompt()
                .user(userMessage)
                .call()
                .content();
        } catch (Exception e) {
            log.warn("Primary chat failed, using fallback", e);
            return generateFallbackResponse(userMessage, e);
        }
    }
    
    // ì¡°ê±´ë¶€ ì²˜ë¦¬
    public ChatResponse adaptiveChat(ChatRequest request) {
        // ì‚¬ìš©ì í”„ë¡œí•„ì— ë”°ë¥¸ ëª¨ë¸ ì„ íƒ
        ChatClient selectedClient = selectOptimalClient(request.getUserProfile());
        
        // ë©”ì‹œì§€ ë³µì¡ë„ì— ë”°ë¥¸ ì²˜ë¦¬ ë°©ì‹
        if (isComplexQuery(request.getMessage())) {
            return handleComplexQuery(selectedClient, request);
        } else {
            return handleSimpleQuery(selectedClient, request);
        }
    }
    
    // ë°°ì¹˜ ì²˜ë¦¬
    public List&lt;String&gt; processBatch(List&lt;String&gt; messages) {
        return messages.parallelStream()
            .map(message -&gt; {
                try {
                    return chatClient.prompt()
                        .user(message)
                        .call()
                        .content();
                } catch (Exception e) {
                    log.error("Failed to process message: {}", message, e);
                    return "ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                }
            })
            .collect(Collectors.toList());
    }
    
    // ì»¨í…ìŠ¤íŠ¸ ëˆ„ì 
    public String conversationalChat(String sessionId, String userMessage) {
        ConversationContext context = getOrCreateContext(sessionId);
        
        try {
            String response = chatClient.prompt()
                .messages(context.getHistory())
                .user(userMessage)
                .call()
                .content();
            
            // ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            context.addUserMessage(userMessage);
            context.addAssistantMessage(response);
            saveContext(sessionId, context);
            
            return response;
            
        } catch (Exception e) {
            log.error("Conversation failed for session: {}", sessionId, e);
            throw new ChatServiceException("ëŒ€í™” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", e);
        }
    }
    
    private ChatClient selectOptimalClient(UserProfile profile) {
        // ì‚¬ìš©ì ì„ í˜¸ë„, ì‚¬ìš©ëŸ‰, ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì„ íƒ
        if (profile.isPremiumUser() && profile.requiresHighPerformance()) {
            return premiumChatClient;
        } else if (profile.getUsage().isNearLimit()) {
            return economyChatClient;
        } else {
            return chatClient;
        }
    }
    
    private boolean isComplexQuery(String message) {
        return message.length() &gt; 500 || 
               message.contains("ë¶„ì„") || 
               message.contains("ì„¤ëª…") ||
               message.contains("ë¹„êµ");
    }
    
    private ChatResponse handleComplexQuery(ChatClient client, ChatRequest request) {
        // ë³µì¡í•œ ì¿¼ë¦¬ëŠ” ë” ìƒì„¸í•œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì‚¬ìš©
        String response = client.prompt()
            .system("""
                ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³  ìƒì„¸í•œ ë¶„ì„ì„ ì œê³µí•˜ëŠ” AIì…ë‹ˆë‹¤.
                ë³µì¡í•œ ì£¼ì œì— ëŒ€í•´ì„œëŠ” ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•˜ê³ ,
                ì˜ˆì œì™€ í•¨ê»˜ ì´í•´í•˜ê¸° ì‰½ê²Œ ë‹µë³€í•˜ì„¸ìš”.
                """)
            .user(request.getMessage())
            .call()
            .content();
        
        return ChatResponse.builder()
            .content(response)
            .type("complex")
            .confidence(calculateConfidence(response))
            .build();
    }
    
    private ChatResponse handleSimpleQuery(ChatClient client, ChatRequest request) {
        // ê°„ë‹¨í•œ ì¿¼ë¦¬ëŠ” ë¹ ë¥¸ ì‘ë‹µ
        String response = client.prompt()
            .user(request.getMessage())
            .call()
            .content();
        
        return ChatResponse.builder()
            .content(response)
            .type("simple")
            .confidence(0.95)
            .build();
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Best Practices -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ğŸ¯ Best Practices</h2>
                
                <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">ì„±ëŠ¥ ìµœì í™”</h3>
                            <ul class="space-y-2 text-sm">
                                <li>âœ… <strong>ìŠ¤íŠ¸ë¦¬ë° í™œìš©</strong>: ê¸´ ì‘ë‹µì€ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì²˜ë¦¬</li>
                                <li>âœ… <strong>í”„ë¡¬í”„íŠ¸ ìµœì í™”</strong>: ëª…í™•í•˜ê³  êµ¬ì²´ì ì¸ ì§€ì‹œ</li>
                                <li>âœ… <strong>í† í° ê´€ë¦¬</strong>: ì»¨í…ìŠ¤íŠ¸ ê¸¸ì´ ëª¨ë‹ˆí„°ë§</li>
                                <li>âœ… <strong>ìºì‹± ì „ëµ</strong>: ë°˜ë³µì ì¸ ìš”ì²­ ìºì‹±</li>
                                <li>âœ… <strong>ë°°ì¹˜ ì²˜ë¦¬</strong>: ë‹¤ì¤‘ ìš”ì²­ ë³‘ë ¬ ì²˜ë¦¬</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-semibold mb-4">ì•ˆì •ì„± ê°•í™”</h3>
                            <ul class="space-y-2 text-sm">
                                <li>âœ… <strong>ì¬ì‹œë„ ë¡œì§</strong>: ì¼ì‹œì  ì˜¤ë¥˜ ëŒ€ì‘</li>
                                <li>âœ… <strong>í´ë°± ì²˜ë¦¬</strong>: ì„œë¹„ìŠ¤ ì¥ì•  ëŒ€ë¹„</li>
                                <li>âœ… <strong>íƒ€ì„ì•„ì›ƒ ì„¤ì •</strong>: ë¬´í•œ ëŒ€ê¸° ë°©ì§€</li>
                                <li>âœ… <strong>ì˜ˆì™¸ ì²˜ë¦¬</strong>: Graceful degradation</li>
                                <li>âœ… <strong>ëª¨ë‹ˆí„°ë§</strong>: ì„±ëŠ¥ ë° ì˜¤ë¥˜ ì¶”ì </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-6 bg-yellow-100 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">âš ï¸ ì£¼ì˜ì‚¬í•­</h4>
                        <ul class="space-y-1 text-sm">
                            <li>â€¢ API ìš”ì²­ ì œí•œ (Rate Limiting) ê³ ë ¤</li>
                            <li>â€¢ ë¯¼ê°í•œ ë°ì´í„° ì²˜ë¦¬ ì‹œ ë³´ì•ˆ ê²€í† </li>
                            <li>â€¢ í† í° ì‚¬ìš©ëŸ‰ì— ë”°ë¥¸ ë¹„ìš© ê´€ë¦¬</li>
                            <li>â€¢ ì‘ë‹µ í’ˆì§ˆ ê²€ì¦ ë¡œì§ êµ¬í˜„</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Navigation -->
            <section class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-xl font-semibold mb-4">ê´€ë ¨ ê°€ì´ë“œ</h2>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <a href="advisors.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-blue-600 mb-2">Advisors</h3>
                        <p class="text-sm text-gray-600">Advisor íŒ¨í„´ìœ¼ë¡œ ChatClient í™•ì¥</p>
                    </a>
                    
                    <a href="tools.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-green-600 mb-2">Tool Calling</h3>
                        <p class="text-sm text-gray-600">í•¨ìˆ˜ í˜¸ì¶œ ê¸°ëŠ¥</p>
                    </a>
                    
                    <a href="templates.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-purple-600 mb-2">Templates</h3>
                        <p class="text-sm text-gray-600">ì½”ë“œ í…œí”Œë¦¿ ëª¨ìŒ</p>
                    </a>
                </div>
            </section>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        function copyCode(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }
    </script>
</body>
</html>