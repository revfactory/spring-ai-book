<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring AI ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .code-block { background: #2d3748; border-radius: 8px; }
        .copy-button { transition: all 0.2s ease; }
        .copy-button:hover { background-color: #4a5568; }
        .metric-card { transition: all 0.3s ease; }
        .metric-card:hover { transform: translateY(-2px); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <a href="../index.html" class="flex items-center text-xl font-bold text-gray-800">
                        <i class="fab fa-spring text-green-600 mr-2"></i>
                        Spring AI Hub
                    </a>
                    <span class="mx-3 text-gray-400">/</span>
                    <span class="text-gray-600">ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ</span>
                </div>
                <a href="../index.html" class="text-blue-600 hover:text-blue-800">
                    <i class="fas fa-home"></i> í™ˆìœ¼ë¡œ
                </a>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl font-bold mb-4">ğŸ“Š Spring AI ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ</h1>
            <p class="text-gray-600 mb-8">AI ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥, ë¹„ìš©, í’ˆì§ˆì„ ì¶”ì í•˜ê³  ìµœì í™”í•˜ëŠ” ë°©ë²•</p>

            <!-- Table of Contents -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">ëª©ì°¨</h2>
                <ul class="space-y-2 text-blue-600">
                    <li><a href="#observability" class="hover:underline">1. AI ê´€ì°°ê°€ëŠ¥ì„± ê¸°ì´ˆ</a></li>
                    <li><a href="#metrics" class="hover:underline">2. í•µì‹¬ ë©”íŠ¸ë¦­</a></li>
                    <li><a href="#implementation" class="hover:underline">3. ëª¨ë‹ˆí„°ë§ êµ¬í˜„</a></li>
                    <li><a href="#dashboards" class="hover:underline">4. ëŒ€ì‹œë³´ë“œ êµ¬ì¶•</a></li>
                    <li><a href="#cost-tracking" class="hover:underline">5. ë¹„ìš© ì¶”ì </a></li>
                    <li><a href="#quality" class="hover:underline">6. í’ˆì§ˆ ëª¨ë‹ˆí„°ë§</a></li>
                    <li><a href="#alerting" class="hover:underline">7. ì•Œë¦¼ ì„¤ì •</a></li>
                    <li><a href="#debugging" class="hover:underline">8. ë””ë²„ê¹… ë„êµ¬</a></li>
                </ul>
            </div>

            <!-- Section 1: Observability Basics -->
            <section id="observability" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">1. AI ê´€ì°°ê°€ëŠ¥ì„± ê¸°ì´ˆ</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">Spring AIì˜ ê´€ì°°ê°€ëŠ¥ì„±</h3>
                    <p class="mb-4">
                        Spring AIëŠ” Micrometerë¥¼ í†µí•´ í¬ê´„ì ì¸ ë©”íŠ¸ë¦­ì„ ì œê³µí•˜ë©°, 
                        Prometheus, Grafana, DataDog ë“± ë‹¤ì–‘í•œ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œê³¼ í†µí•©ë©ë‹ˆë‹¤.
                    </p>
                    
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">ğŸ“ˆ ë©”íŠ¸ë¦­</h4>
                            <ul class="text-sm space-y-1">
                                <li>â€¢ ì‘ë‹µ ì‹œê°„</li>
                                <li>â€¢ í† í° ì‚¬ìš©ëŸ‰</li>
                                <li>â€¢ ì˜¤ë¥˜ìœ¨</li>
                                <li>â€¢ ì²˜ë¦¬ëŸ‰</li>
                            </ul>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">ğŸ“ ë¡œê¹…</h4>
                            <ul class="text-sm space-y-1">
                                <li>â€¢ ìš”ì²­/ì‘ë‹µ ë¡œê·¸</li>
                                <li>â€¢ ì˜¤ë¥˜ ì¶”ì </li>
                                <li>â€¢ ì‚¬ìš©ì í™œë™</li>
                                <li>â€¢ ì‹œìŠ¤í…œ ì´ë²¤íŠ¸</li>
                            </ul>
                        </div>
                        
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">ğŸ” ì¶”ì </h4>
                            <ul class="text-sm space-y-1">
                                <li>â€¢ ë¶„ì‚° ì¶”ì </li>
                                <li>â€¢ ìš”ì²­ íë¦„</li>
                                <li>â€¢ ì˜ì¡´ì„± ë§µ</li>
                                <li>â€¢ ì„±ëŠ¥ ë³‘ëª©</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Core Metrics -->
            <section id="metrics" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">2. í•µì‹¬ ë©”íŠ¸ë¦­</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">AI ì• í”Œë¦¬ì¼€ì´ì…˜ í•µì‹¬ ì§€í‘œ</h3>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="metric-card border rounded-lg p-4">
                            <h4 class="font-semibold text-blue-600 mb-2">ğŸš€ ì„±ëŠ¥ ë©”íŠ¸ë¦­</h4>
                            <ul class="space-y-1 text-sm">
                                <li><strong>ì‘ë‹µ ì‹œê°„ (P50, P95, P99)</strong></li>
                                <li><strong>ì²˜ë¦¬ëŸ‰ (ìš”ì²­/ì´ˆ)</strong></li>
                                <li><strong>ë™ì‹œ ìš”ì²­ ìˆ˜</strong></li>
                                <li><strong>í ëŒ€ê¸° ì‹œê°„</strong></li>
                            </ul>
                        </div>
                        
                        <div class="metric-card border rounded-lg p-4">
                            <h4 class="font-semibold text-green-600 mb-2">ğŸ’° ë¹„ìš© ë©”íŠ¸ë¦­</h4>
                            <ul class="space-y-1 text-sm">
                                <li><strong>í† í° ì‚¬ìš©ëŸ‰ (ì…ë ¥/ì¶œë ¥)</strong></li>
                                <li><strong>API í˜¸ì¶œ ìˆ˜</strong></li>
                                <li><strong>ëª¨ë¸ë³„ ë¹„ìš©</strong></li>
                                <li><strong>ì‚¬ìš©ìë³„ ë¹„ìš©</strong></li>
                            </ul>
                        </div>
                        
                        <div class="metric-card border rounded-lg p-4">
                            <h4 class="font-semibold text-purple-600 mb-2">ğŸ“Š í’ˆì§ˆ ë©”íŠ¸ë¦­</h4>
                            <ul class="space-y-1 text-sm">
                                <li><strong>ì‘ë‹µ ì •í™•ë„</strong></li>
                                <li><strong>ì‚¬ìš©ì ë§Œì¡±ë„</strong></li>
                                <li><strong>ì™„ì„±ë¥ </strong></li>
                                <li><strong>ì¬ì‹œë„ìœ¨</strong></li>
                            </ul>
                        </div>
                        
                        <div class="metric-card border rounded-lg p-4">
                            <h4 class="font-semibold text-red-600 mb-2">âš ï¸ ì‹ ë¢°ì„± ë©”íŠ¸ë¦­</h4>
                            <ul class="space-y-1 text-sm">
                                <li><strong>ì˜¤ë¥˜ìœ¨</strong></li>
                                <li><strong>ê°€ìš©ì„±</strong></li>
                                <li><strong>íƒ€ì„ì•„ì›ƒ íšŸìˆ˜</strong></li>
                                <li><strong>íšŒë¡œ ì°¨ë‹¨ê¸° ìƒíƒœ</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Implementation -->
            <section id="implementation" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">3. ëª¨ë‹ˆí„°ë§ êµ¬í˜„</h2>
                
                <!-- Basic Setup -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ê¸°ë³¸ ì„¤ì •</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì˜ì¡´ì„± ì¶”ê°€</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('dependencies')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="dependencies"><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
    &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
    &lt;artifactId&gt;micrometer-tracing-bridge-otel&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì„¤ì • íŒŒì¼</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('config-yaml')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="config-yaml"><code class="language-yaml">management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
    metrics:
      enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
      environment: ${spring.profiles.active}
    distribution:
      percentiles-histogram:
        http.server.requests: true
        ai.chat.duration: true
      percentiles:
        http.server.requests: 0.5,0.95,0.99
        ai.chat.duration: 0.5,0.95,0.99
  
spring:
  ai:
    chat:
      observation:
        enabled: true
    embedding:
      observation:
        enabled: true
    vectorstore:
      observation:
        enabled: true</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Custom Metrics -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ êµ¬í˜„</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('custom-metrics')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="custom-metrics"><code class="language-java">@Component
@Slf4j
public class AIMetricsCollector {
    
    private final MeterRegistry meterRegistry;
    private final Counter tokenCounter;
    private final Timer responseTimer;
    private final AtomicDouble currentCost;
    
    public AIMetricsCollector(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        
        // í† í° ì¹´ìš´í„°
        this.tokenCounter = Counter.builder("ai.tokens.used")
            .description("Total tokens used")
            .tag("type", "total")
            .register(meterRegistry);
        
        // ì‘ë‹µ ì‹œê°„ íƒ€ì´ë¨¸
        this.responseTimer = Timer.builder("ai.response.duration")
            .description("AI response time")
            .publishPercentiles(0.5, 0.95, 0.99)
            .register(meterRegistry);
        
        // í˜„ì¬ ë¹„ìš© ê²Œì´ì§€
        this.currentCost = new AtomicDouble(0.0);
        Gauge.builder("ai.cost.current", currentCost, AtomicDouble::get)
            .description("Current AI API cost")
            .baseUnit("dollars")
            .register(meterRegistry);
    }
    
    // ChatClient ì¸í„°ì…‰í„°
    @Component
    public class ChatClientInterceptor implements ClientRequestObservationConvention {
        
        @Override
        public void onResponse(ClientRequestObservationContext context) {
            ChatResponse response = context.getResponse();
            
            if (response != null && response.getMetadata() != null) {
                // í† í° ì‚¬ìš©ëŸ‰ ê¸°ë¡
                Usage usage = response.getMetadata().getUsage();
                if (usage != null) {
                    recordTokenUsage(usage);
                }
                
                // ëª¨ë¸ë³„ ë©”íŠ¸ë¦­
                String model = response.getMetadata().getModel();
                recordModelMetrics(model, usage);
                
                // ë¹„ìš© ê³„ì‚°
                double cost = calculateCost(model, usage);
                currentCost.addAndGet(cost);
                
                // ì‘ë‹µ í’ˆì§ˆ ë©”íŠ¸ë¦­
                recordQualityMetrics(response);
            }
        }
        
        private void recordTokenUsage(Usage usage) {
            meterRegistry.counter("ai.tokens.input", 
                "model", usage.getModel())
                .increment(usage.getPromptTokens());
            
            meterRegistry.counter("ai.tokens.output", 
                "model", usage.getModel())
                .increment(usage.getCompletionTokens());
            
            tokenCounter.increment(usage.getTotalTokens());
        }
        
        private void recordModelMetrics(String model, Usage usage) {
            Tags tags = Tags.of("model", model);
            
            // ëª¨ë¸ë³„ í˜¸ì¶œ íšŸìˆ˜
            meterRegistry.counter("ai.model.calls", tags).increment();
            
            // ëª¨ë¸ë³„ í‰ê·  í† í° ì‚¬ìš©ëŸ‰
            meterRegistry.gauge("ai.model.avg.tokens", tags, 
                usage.getTotalTokens());
        }
    }
    
    // ë²¡í„° ìŠ¤í† ì–´ ë©”íŠ¸ë¦­
    @EventListener
    public void handleVectorStoreEvent(VectorStoreObservationEvent event) {
        String operation = event.getOperation();
        
        meterRegistry.counter("vectorstore.operations",
            "operation", operation,
            "store", event.getVectorStoreName()
        ).increment();
        
        if (event.getDuration() != null) {
            meterRegistry.timer("vectorstore.operation.duration",
                "operation", operation
            ).record(event.getDuration());
        }
        
        if (event.getDocumentCount() != null) {
            meterRegistry.gauge("vectorstore.documents.processed",
                Tags.of("operation", operation),
                event.getDocumentCount()
            );
        }
    }
    
    // ë¹„ì¦ˆë‹ˆìŠ¤ ë©”íŠ¸ë¦­
    public void recordBusinessMetric(String metricName, double value, Tags tags) {
        meterRegistry.gauge("business." + metricName, tags, value);
    }
    
    // ì—ëŸ¬ ì¶”ì 
    @EventListener
    public void handleError(AIErrorEvent event) {
        meterRegistry.counter("ai.errors",
            "type", event.getErrorType(),
            "model", event.getModel(),
            "operation", event.getOperation()
        ).increment();
        
        // ì—ëŸ¬ìœ¨ ê³„ì‚°
        double errorRate = calculateErrorRate(event.getModel());
        meterRegistry.gauge("ai.error.rate",
            Tags.of("model", event.getModel()),
            errorRate
        );
    }
}</code></pre>
                    </div>
                </div>

                <!-- Tracing Implementation -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ë¶„ì‚° ì¶”ì  êµ¬í˜„</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('tracing')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="tracing"><code class="language-java">@Component
public class AITracingConfiguration {
    
    @Bean
    public ObservationCustomizer<ClientRequestObservationContext> aiObservationCustomizer() {
        return (context, observation) -> {
            observation.lowCardinalityKeyValue("ai.provider", getProvider(context));
            observation.lowCardinalityKeyValue("ai.model", getModel(context));
            observation.highCardinalityKeyValue("ai.prompt.hash", hashPrompt(context));
        };
    }
    
    @Component
    public class TracedAIService {
        
        private final ObservationRegistry observationRegistry;
        private final ChatClient chatClient;
        
        public String processWithTracing(String input) {
            return Observation.createNotStarted("ai.process", observationRegistry)
                .contextualName("process-user-input")
                .lowCardinalityKeyValue("input.type", classifyInput(input))
                .observe(() -> {
                    // í”„ë¡¬í”„íŠ¸ ì¤€ë¹„ ë‹¨ê³„
                    String prompt = Observation.createNotStarted("ai.prompt.prepare", observationRegistry)
                        .observe(() -> preparePrompt(input));
                    
                    // AI í˜¸ì¶œ ë‹¨ê³„
                    String response = Observation.createNotStarted("ai.chat.call", observationRegistry)
                        .observe(() -> chatClient.prompt()
                            .user(prompt)
                            .call()
                            .content());
                    
                    // í›„ì²˜ë¦¬ ë‹¨ê³„
                    return Observation.createNotStarted("ai.response.process", observationRegistry)
                        .observe(() -> processResponse(response));
                });
        }
    }
    
    // ì»¤ìŠ¤í…€ ìŠ¤íŒ¬ ì¶”ê°€
    @Component
    public class CustomSpanAspect {
        
        private final Tracer tracer;
        
        @Around("@annotation(Traced)")
        public Object trace(ProceedingJoinPoint pjp, Traced traced) throws Throwable {
            Span span = tracer.nextSpan()
                .name(traced.value())
                .tag("component", "spring-ai")
                .start();
            
            try (Tracer.SpanInScope ws = tracer.withSpanInScope(span)) {
                Object result = pjp.proceed();
                
                // ê²°ê³¼ ë©”íƒ€ë°ì´í„° ì¶”ê°€
                if (result instanceof ChatResponse) {
                    ChatResponse response = (ChatResponse) result;
                    span.tag("tokens.used", String.valueOf(response.getTokensUsed()));
                    span.tag("model", response.getModel());
                }
                
                return result;
            } catch (Exception e) {
                span.error(e);
                throw e;
            } finally {
                span.end();
            }
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 4: Dashboards -->
            <section id="dashboards" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">4. ëŒ€ì‹œë³´ë“œ êµ¬ì¶•</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">Grafana ëŒ€ì‹œë³´ë“œ</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ëŒ€ì‹œë³´ë“œ JSON ì„¤ì •</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('grafana-dashboard')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="grafana-dashboard"><code class="language-json">{
  "dashboard": {
    "title": "Spring AI Monitoring",
    "panels": [
      {
        "title": "AI Request Rate",
        "targets": [{
          "expr": "rate(ai_chat_requests_total[5m])"
        }],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0}
      },
      {
        "title": "Token Usage",
        "targets": [{
          "expr": "sum(rate(ai_tokens_used_total[5m])) by (model)"
        }],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0}
      },
      {
        "title": "Response Time (P95)",
        "targets": [{
          "expr": "histogram_quantile(0.95, rate(ai_response_duration_seconds_bucket[5m]))"
        }],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8}
      },
      {
        "title": "Error Rate",
        "targets": [{
          "expr": "sum(rate(ai_errors_total[5m])) by (type)"
        }],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8}
      },
      {
        "title": "Cost per Hour",
        "targets": [{
          "expr": "sum(increase(ai_cost_current[1h]))"
        }],
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 16}
      }
    ]
  }
}</code></pre>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ êµ¬í˜„</h4>
                        <div class="code-block p-4 relative">
                            <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                    onclick="copyCode('realtime-dashboard')">
                                <i class="fas fa-copy"></i> ë³µì‚¬
                            </button>
                            <pre id="realtime-dashboard"><code class="language-java">@RestController
@RequestMapping("/api/metrics")
public class MetricsDashboardController {
    
    private final MeterRegistry meterRegistry;
    private final MetricsAggregator aggregator;
    
    @GetMapping(value = "/stream", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux<ServerSentEvent<DashboardMetrics>> streamMetrics() {
        return Flux.interval(Duration.ofSeconds(1))
            .map(tick -> {
                DashboardMetrics metrics = collectCurrentMetrics();
                
                return ServerSentEvent.<DashboardMetrics>builder()
                    .id(String.valueOf(tick))
                    .event("metrics")
                    .data(metrics)
                    .build();
            })
            .doOnCancel(() -> log.info("Dashboard stream cancelled"));
    }
    
    private DashboardMetrics collectCurrentMetrics() {
        return DashboardMetrics.builder()
            // ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­
            .requestRate(getRate("ai.chat.requests"))
            .avgResponseTime(getAverage("ai.response.duration"))
            .activeRequests(getGauge("ai.requests.active"))
            .tokenUsageRate(getRate("ai.tokens.used"))
            
            // ëˆ„ì  ë©”íŠ¸ë¦­
            .totalRequests(getCounter("ai.chat.requests"))
            .totalTokens(getCounter("ai.tokens.used"))
            .totalCost(getGauge("ai.cost.current"))
            
            // ì˜¤ë¥˜ ë©”íŠ¸ë¦­
            .errorRate(getRate("ai.errors"))
            .lastError(aggregator.getLastError())
            
            // ëª¨ë¸ë³„ ë©”íŠ¸ë¦­
            .modelMetrics(getModelMetrics())
            
            // ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
            .cpuUsage(getSystemCpuUsage())
            .memoryUsage(getMemoryUsage())
            
            .timestamp(Instant.now())
            .build();
    }
    
    @GetMapping("/summary")
    public MetricsSummary getMetricsSummary(
            @RequestParam(defaultValue = "1h") String timeRange) {
        
        return MetricsSummary.builder()
            .timeRange(timeRange)
            .overview(aggregator.getOverview(timeRange))
            .topModels(aggregator.getTopModels(5))
            .costBreakdown(aggregator.getCostBreakdown())
            .performanceTrends(aggregator.getPerformanceTrends())
            .qualityMetrics(aggregator.getQualityMetrics())
            .build();
    }
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Cost Tracking -->
            <section id="cost-tracking" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">5. ë¹„ìš© ì¶”ì </h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">AI API ë¹„ìš© ëª¨ë‹ˆí„°ë§</h3>
                    
                    <div class="code-block p-4 relative mb-6">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('cost-tracking')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="cost-tracking"><code class="language-java">@Service
@Slf4j
public class AICostTrackingService {
    
    private final MeterRegistry meterRegistry;
    private final CostCalculator costCalculator;
    private final BudgetManager budgetManager;
    
    // ëª¨ë¸ë³„ ê°€ê²© ì •ë³´ (2024ë…„ ê¸°ì¤€)
    private static final Map<String, ModelPricing> MODEL_PRICING = Map.of(
        "gpt-4o", new ModelPricing(0.015, 0.06),  // $15/$60 per 1M tokens
        "gpt-4o-mini", new ModelPricing(0.00015, 0.0006),
        "claude-3-5-sonnet", new ModelPricing(0.018, 0.072),
        "embedding-3-small", new ModelPricing(0.00002, 0)
    );
    
    @EventListener
    public void trackCost(ChatModelObservationEvent event) {
        if (event.getUsage() != null) {
            double cost = calculateCost(event);
            
            // ë¹„ìš© ë©”íŠ¸ë¦­ ê¸°ë¡
            recordCostMetrics(event, cost);
            
            // ì˜ˆì‚° í™•ì¸
            checkBudget(cost);
            
            // ë¹„ìš© ì´ìƒ ê°ì§€
            detectCostAnomaly(event, cost);
        }
    }
    
    private double calculateCost(ChatModelObservationEvent event) {
        Usage usage = event.getUsage();
        ModelPricing pricing = MODEL_PRICING.get(event.getModel());
        
        if (pricing == null) {
            log.warn("Unknown model pricing: {}", event.getModel());
            return 0.0;
        }
        
        double inputCost = (usage.getPromptTokens() / 1_000_000.0) * pricing.getInputPrice();
        double outputCost = (usage.getCompletionTokens() / 1_000_000.0) * pricing.getOutputPrice();
        
        return inputCost + outputCost;
    }
    
    private void recordCostMetrics(ChatModelObservationEvent event, double cost) {
        Tags tags = Tags.of(
            "model", event.getModel(),
            "user", event.getUserId(),
            "operation", event.getOperation()
        );
        
        // ì¦‰ì‹œ ë¹„ìš©
        meterRegistry.counter("ai.cost.instant", tags).increment(cost);
        
        // ëˆ„ì  ë¹„ìš©
        meterRegistry.gauge("ai.cost.cumulative", tags, 
            () -> getCumulativeCost(event.getUserId()));
        
        // ì‹œê°„ë‹¹ ë¹„ìš©
        meterRegistry.gauge("ai.cost.hourly", tags,
            () -> getHourlyCost(event.getUserId()));
    }
    
    // ì˜ˆì‚° ê´€ë¦¬
    @Component
    public class BudgetManager {
        
        private final Map<String, Budget> userBudgets = new ConcurrentHashMap<>();
        private final Budget globalBudget;
        
        public void checkBudget(String userId, double cost) {
            // ì‚¬ìš©ìë³„ ì˜ˆì‚° í™•ì¸
            Budget userBudget = userBudgets.get(userId);
            if (userBudget != null) {
                userBudget.addCost(cost);
                
                if (userBudget.isExceeded()) {
                    handleBudgetExceeded(userId, userBudget);
                } else if (userBudget.isNearLimit()) {
                    sendBudgetWarning(userId, userBudget);
                }
            }
            
            // ì „ì²´ ì˜ˆì‚° í™•ì¸
            globalBudget.addCost(cost);
            if (globalBudget.isExceeded()) {
                handleGlobalBudgetExceeded();
            }
        }
        
        private void handleBudgetExceeded(String userId, Budget budget) {
            log.error("Budget exceeded for user: {}, spent: ${}, limit: ${}", 
                userId, budget.getSpent(), budget.getLimit());
            
            // ì‚¬ìš©ì ì°¨ë‹¨
            rateLimiter.blockUser(userId);
            
            // ì•Œë¦¼ ë°œì†¡
            notificationService.sendBudgetAlert(userId, budget);
            
            // ë©”íŠ¸ë¦­ ê¸°ë¡
            meterRegistry.counter("ai.budget.exceeded", "user", userId).increment();
        }
    }
    
    // ë¹„ìš© ì´ìƒ ê°ì§€
    public void detectCostAnomaly(ChatModelObservationEvent event, double cost) {
        String userId = event.getUserId();
        
        // í‰ê·  ë¹„ìš© ëŒ€ë¹„ ì´ìƒ ê°ì§€
        double avgCost = getAverageCost(userId);
        double threshold = avgCost * 5; // í‰ê· ì˜ 5ë°°
        
        if (cost > threshold && cost > 1.0) { // $1 ì´ìƒ
            log.warn("Cost anomaly detected - User: {}, Cost: ${}, Avg: ${}", 
                userId, cost, avgCost);
            
            // ìƒì„¸ ë¶„ì„
            CostAnomaly anomaly = CostAnomaly.builder()
                .userId(userId)
                .cost(cost)
                .averageCost(avgCost)
                .model(event.getModel())
                .tokenCount(event.getUsage().getTotalTokens())
                .timestamp(Instant.now())
                .build();
            
            // ì•Œë¦¼
            alertManager.sendCostAnomaly(anomaly);
            
            // ìë™ ì¡°ì¹˜
            if (cost > 10.0) { // $10 ì´ìƒ
                temporarilyLimitUser(userId);
            }
        }
    }
    
    // ë¹„ìš© ë¦¬í¬íŠ¸ ìƒì„±
    @Scheduled(cron = "0 0 8 * * *") // ë§¤ì¼ ì˜¤ì „ 8ì‹œ
    public void generateDailyCostReport() {
        LocalDate yesterday = LocalDate.now().minusDays(1);
        
        CostReport report = CostReport.builder()
            .date(yesterday)
            .totalCost(getTotalCost(yesterday))
            .costByModel(getCostByModel(yesterday))
            .costByUser(getTopUsers(yesterday, 10))
            .costByHour(getHourlyCostBreakdown(yesterday))
            .anomalies(getAnomalies(yesterday))
            .projectedMonthlyCost(projectMonthlyCost())
            .build();
        
        // ë¦¬í¬íŠ¸ ì €ì¥
        costReportRepository.save(report);
        
        // ì´ë©”ì¼ ë°œì†¡
        emailService.sendCostReport(report);
        
        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        dashboardService.updateCostMetrics(report);
    }
}</code></pre>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">ë¹„ìš© ìµœì í™” íŒ</h4>
                        <ul class="space-y-1 text-sm">
                            <li>â€¢ í”„ë¡¬í”„íŠ¸ ìºì‹±ìœ¼ë¡œ ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€</li>
                            <li>â€¢ ì ì ˆí•œ ëª¨ë¸ ì„ íƒ (ì‘ì—…ì— ë§ëŠ” ëª¨ë¸ ì‚¬ìš©)</li>
                            <li>â€¢ í† í° ì‚¬ìš©ëŸ‰ ìµœì í™” (ë¶ˆí•„ìš”í•œ ë‚´ìš© ì œê±°)</li>
                            <li>â€¢ ë°°ì¹˜ ì²˜ë¦¬ë¡œ API í˜¸ì¶œ ìˆ˜ ê°ì†Œ</li>
                            <li>â€¢ ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µìœ¼ë¡œ ë¶€ë¶„ ì·¨ì†Œ ê°€ëŠ¥</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: Quality Monitoring -->
            <section id="quality" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">6. í’ˆì§ˆ ëª¨ë‹ˆí„°ë§</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">AI ì‘ë‹µ í’ˆì§ˆ ì¶”ì </h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('quality-monitoring')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="quality-monitoring"><code class="language-java">@Service
public class AIQualityMonitoringService {
    
    private final MeterRegistry meterRegistry;
    private final QualityEvaluator evaluator;
    
    // ì‘ë‹µ í’ˆì§ˆ í‰ê°€
    public QualityMetrics evaluateResponse(
            String prompt, 
            String response, 
            Map<String, Object> context) {
        
        QualityMetrics metrics = QualityMetrics.builder()
            .relevance(evaluateRelevance(prompt, response))
            .coherence(evaluateCoherence(response))
            .completeness(evaluateCompleteness(prompt, response))
            .accuracy(evaluateAccuracy(response, context))
            .toxicity(evaluateToxicity(response))
            .build();
        
        recordQualityMetrics(metrics);
        
        return metrics;
    }
    
    // ê´€ë ¨ì„± í‰ê°€
    private double evaluateRelevance(String prompt, String response) {
        // ì˜ë¯¸ë¡ ì  ìœ ì‚¬ë„ ê³„ì‚°
        float[] promptEmbedding = embeddingModel.embed(prompt);
        float[] responseEmbedding = embeddingModel.embed(response);
        
        double similarity = cosineSimilarity(promptEmbedding, responseEmbedding);
        
        // í‚¤ì›Œë“œ ë§¤ì¹­
        Set<String> promptKeywords = extractKeywords(prompt);
        Set<String> responseKeywords = extractKeywords(response);
        
        double keywordOverlap = calculateJaccardSimilarity(
            promptKeywords, 
            responseKeywords
        );
        
        return (similarity * 0.7 + keywordOverlap * 0.3);
    }
    
    // ì¼ê´€ì„± í‰ê°€
    private double evaluateCoherence(String response) {
        String coherencePrompt = """
            ë‹¤ìŒ í…ìŠ¤íŠ¸ì˜ ì¼ê´€ì„±ì„ 0-1 ì‚¬ì´ì˜ ì ìˆ˜ë¡œ í‰ê°€í•˜ì„¸ìš”:
            
            í…ìŠ¤íŠ¸: {text}
            
            í‰ê°€ ê¸°ì¤€:
            - ë…¼ë¦¬ì  íë¦„
            - ë¬¸ì¥ ê°„ ì—°ê²°ì„±
            - ì£¼ì œ ì¼ê´€ì„±
            
            ì ìˆ˜ë§Œ ë°˜í™˜í•˜ì„¸ìš”.
            """;
        
        String score = chatClient.prompt()
            .user(u -> u.text(coherencePrompt).param("text", response))
            .call()
            .content();
        
        return Double.parseDouble(score);
    }
    
    // ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
    @RestController
    @RequestMapping("/api/feedback")
    public class FeedbackController {
        
        @PostMapping
        public void collectFeedback(@RequestBody UserFeedback feedback) {
            // í”¼ë“œë°± ì €ì¥
            feedbackRepository.save(feedback);
            
            // ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
            updateQualityMetrics(feedback);
            
            // í•™ìŠµ ë°ì´í„° ìƒì„±
            if (feedback.isUsefulForTraining()) {
                trainingDataService.addExample(
                    feedback.getPrompt(),
                    feedback.getResponse(),
                    feedback.getRating()
                );
            }
        }
        
        private void updateQualityMetrics(UserFeedback feedback) {
            Tags tags = Tags.of(
                "model", feedback.getModel(),
                "category", feedback.getCategory()
            );
            
            // í‰ê·  í‰ì 
            meterRegistry.gauge("ai.quality.user.rating", tags, 
                feedback.getRating());
            
            // ë§Œì¡±ë„
            if (feedback.getRating() >= 4) {
                meterRegistry.counter("ai.quality.satisfied", tags).increment();
            } else {
                meterRegistry.counter("ai.quality.unsatisfied", tags).increment();
            }
            
            // êµ¬ì²´ì  í”¼ë“œë°± ìœ í˜•
            feedback.getIssues().forEach(issue -> {
                meterRegistry.counter("ai.quality.issues", 
                    tags.and("issue", issue)).increment();
            });
        }
    }
    
    // A/B í…ŒìŠ¤íŠ¸ í’ˆì§ˆ ë¹„êµ
    @Component
    public class ABTestQualityAnalyzer {
        
        public ABTestResult compareModels(String testId) {
            List<TestResult> groupA = getTestResults(testId, "A");
            List<TestResult> groupB = getTestResults(testId, "B");
            
            return ABTestResult.builder()
                .testId(testId)
                .groupAMetrics(calculateMetrics(groupA))
                .groupBMetrics(calculateMetrics(groupB))
                .statisticalSignificance(calculateSignificance(groupA, groupB))
                .recommendation(generateRecommendation(groupA, groupB))
                .build();
        }
        
        private GroupMetrics calculateMetrics(List<TestResult> results) {
            return GroupMetrics.builder()
                .avgResponseTime(calculateAverage(results, TestResult::getResponseTime))
                .avgQualityScore(calculateAverage(results, TestResult::getQualityScore))
                .successRate(calculateSuccessRate(results))
                .userSatisfaction(calculateSatisfaction(results))
                .costPerRequest(calculateAvgCost(results))
                .build();
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 7: Alerting -->
            <section id="alerting" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">7. ì•Œë¦¼ ì„¤ì •</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-3">ì§€ëŠ¥í˜• ì•Œë¦¼ ì‹œìŠ¤í…œ</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('alerting-system')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="alerting-system"><code class="language-java">@Service
@Slf4j
public class AIAlertingService {
    
    private final AlertManager alertManager;
    private final MeterRegistry meterRegistry;
    
    // ì•Œë¦¼ ê·œì¹™ ì •ì˜
    @Configuration
    public class AlertRules {
        
        @Bean
        public List<AlertRule> aiAlertRules() {
            return List.of(
                // ë†’ì€ ì˜¤ë¥˜ìœ¨
                AlertRule.builder()
                    .name("high-error-rate")
                    .condition("rate(ai_errors_total[5m]) > 0.1")
                    .severity(AlertSeverity.CRITICAL)
                    .message("AI ì˜¤ë¥˜ìœ¨ì´ 10%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤")
                    .actions(List.of(
                        new SlackNotification("#ai-alerts"),
                        new EmailNotification("team@company.com"),
                        new CircuitBreakerAction()
                    ))
                    .build(),
                
                // ëŠë¦° ì‘ë‹µ ì‹œê°„
                AlertRule.builder()
                    .name("slow-response")
                    .condition("histogram_quantile(0.95, ai_response_duration_seconds) > 10")
                    .severity(AlertSeverity.WARNING)
                    .message("P95 ì‘ë‹µ ì‹œê°„ì´ 10ì´ˆë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤")
                    .build(),
                
                // ë¹„ìš© ê¸‰ì¦
                AlertRule.builder()
                    .name("cost-spike")
                    .condition("increase(ai_cost_current[1h]) > 100")
                    .severity(AlertSeverity.HIGH)
                    .message("ì‹œê°„ë‹¹ ë¹„ìš©ì´ $100ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤")
                    .build(),
                
                // í† í° ì‚¬ìš©ëŸ‰ ì´ìƒ
                AlertRule.builder()
                    .name("token-anomaly")
                    .condition("ai_tokens_per_request > 3000")
                    .severity(AlertSeverity.MEDIUM)
                    .message("ìš”ì²­ë‹¹ í† í° ì‚¬ìš©ëŸ‰ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ìŠµë‹ˆë‹¤")
                    .build()
            );
        }
    }
    
    // ë™ì  ì„ê³„ê°’ ì¡°ì •
    @Component
    public class DynamicThresholdManager {
        
        @Scheduled(fixedRate = 300000) // 5ë¶„ë§ˆë‹¤
        public void adjustThresholds() {
            // ê³¼ê±° ë°ì´í„° ê¸°ë°˜ ì„ê³„ê°’ ê³„ì‚°
            Map<String, Double> thresholds = calculateDynamicThresholds();
            
            thresholds.forEach((metric, threshold) -> {
                alertManager.updateThreshold(metric, threshold);
                log.info("Updated threshold for {}: {}", metric, threshold);
            });
        }
        
        private Map<String, Double> calculateDynamicThresholds() {
            Map<String, Double> thresholds = new HashMap<>();
            
            // ì‘ë‹µ ì‹œê°„ ì„ê³„ê°’ (P99 + 50%)
            double p99ResponseTime = getPercentile("ai_response_duration", 0.99);
            thresholds.put("response_time", p99ResponseTime * 1.5);
            
            // ì˜¤ë¥˜ìœ¨ ì„ê³„ê°’ (í‰ê·  + 3Ïƒ)
            double avgErrorRate = getAverage("ai_error_rate");
            double stdDev = getStandardDeviation("ai_error_rate");
            thresholds.put("error_rate", avgErrorRate + 3 * stdDev);
            
            return thresholds;
        }
    }
    
    // ì•Œë¦¼ ì§‘ê³„ ë° ì–µì œ
    @Component
    public class AlertAggregator {
        
        private final Map<String, AlertGroup> activeAlerts = new ConcurrentHashMap<>();
        
        public void processAlert(Alert alert) {
            String groupKey = alert.getGroupKey();
            
            AlertGroup group = activeAlerts.computeIfAbsent(
                groupKey, 
                k -> new AlertGroup()
            );
            
            group.add(alert);
            
            // ì§‘ê³„ ë¡œì§
            if (group.shouldSendNotification()) {
                sendAggregatedAlert(group);
                group.markNotified();
            }
        }
        
        private void sendAggregatedAlert(AlertGroup group) {
            AggregatedAlert aggregated = AggregatedAlert.builder()
                .title(group.getTitle())
                .count(group.getCount())
                .firstOccurrence(group.getFirstOccurrence())
                .lastOccurrence(group.getLastOccurrence())
                .severity(group.getHighestSeverity())
                .details(group.getSummary())
                .build();
            
            alertManager.send(aggregated);
        }
    }
    
    // ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ë¼ìš°íŒ…
    @Component
    public class SmartAlertRouter {
        
        public void routeAlert(Alert alert) {
            // ì‹œê°„ëŒ€ë³„ ë¼ìš°íŒ…
            if (isBusinessHours()) {
                routeToSlack(alert);
            } else if (alert.getSeverity() == AlertSeverity.CRITICAL) {
                routeToPagerDuty(alert);
            } else {
                queueForNextBusinessDay(alert);
            }
            
            // ë‹´ë‹¹ì ìë™ í• ë‹¹
            String assignee = determineAssignee(alert);
            alert.setAssignee(assignee);
            
            // ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€
            enrichAlertContext(alert);
        }
        
        private void enrichAlertContext(Alert alert) {
            alert.addContext("recent_changes", getRecentChanges());
            alert.addContext("similar_incidents", findSimilarIncidents(alert));
            alert.addContext("recommended_actions", suggestActions(alert));
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 8: Debugging -->
            <section id="debugging" class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">8. ë””ë²„ê¹… ë„êµ¬</h2>
                
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="text-lg font-semibold mb-3">AI ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹…</h3>
                    
                    <div class="code-block p-4 relative">
                        <button class="copy-button absolute top-2 right-2 bg-gray-600 text-white px-2 py-1 rounded text-xs" 
                                onclick="copyCode('debugging-tools')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <pre id="debugging-tools"><code class="language-java">@Component
@Profile("debug")
public class AIDebugger {
    
    // í”„ë¡¬í”„íŠ¸ ë””ë²„ê±°
    @Component
    public class PromptDebugger {
        
        @EventListener
        public void debugPrompt(ChatPromptEvent event) {
            log.debug("=== PROMPT DEBUG ===");
            log.debug("Timestamp: {}", Instant.now());
            log.debug("User: {}", event.getUserId());
            log.debug("Model: {}", event.getModel());
            log.debug("System Prompt: {}", event.getSystemPrompt());
            log.debug("User Prompt: {}", event.getUserPrompt());
            log.debug("Parameters: {}", event.getParameters());
            log.debug("Token Estimate: {}", estimateTokens(event));
            log.debug("==================");
            
            // í”„ë¡¬í”„íŠ¸ ì €ì¥ (ë””ë²„ê¹…ìš©)
            if (debugConfig.isSavePrompts()) {
                savePromptForAnalysis(event);
            }
        }
        
        @EventListener
        public void debugResponse(ChatResponseEvent event) {
            log.debug("=== RESPONSE DEBUG ===");
            log.debug("Request ID: {}", event.getRequestId());
            log.debug("Response Time: {}ms", event.getDuration());
            log.debug("Tokens Used: {}", event.getTokensUsed());
            log.debug("Cost: ${}", event.getEstimatedCost());
            log.debug("Response Preview: {}", 
                StringUtils.abbreviate(event.getResponse(), 200));
            log.debug("====================");
        }
    }
    
    // í† í° ë¶„ì„ê¸°
    @RestController
    @RequestMapping("/debug/tokens")
    public class TokenAnalyzer {
        
        @PostMapping("/analyze")
        public TokenAnalysis analyzeTokens(@RequestBody String text) {
            List<String> tokens = tokenizer.tokenize(text);
            
            return TokenAnalysis.builder()
                .text(text)
                .tokenCount(tokens.size())
                .tokens(tokens)
                .characterCount(text.length())
                .estimatedCost(calculateCost(tokens.size()))
                .modelRecommendation(recommendModel(tokens.size()))
                .optimizationSuggestions(suggestOptimizations(text))
                .build();
        }
    }
    
    // ëŒ€í™” ì¬í˜„ ë„êµ¬
    @Component
    public class ConversationReplayer {
        
        public ReplayResult replayConversation(String conversationId) {
            List<ConversationTurn> turns = loadConversation(conversationId);
            List<ReplayStep> steps = new ArrayList<>();
            
            for (ConversationTurn turn : turns) {
                // ì›ë³¸ ìš”ì²­ ì¬í˜„
                ChatResponse original = turn.getResponse();
                
                // ìƒˆë¡œìš´ ìš”ì²­ ì‹¤í–‰
                ChatResponse replayed = chatClient.prompt()
                    .system(turn.getSystemPrompt())
                    .user(turn.getUserPrompt())
                    .call();
                
                // ë¹„êµ ë¶„ì„
                DiffAnalysis diff = analyzeDifference(original, replayed);
                
                steps.add(ReplayStep.builder()
                    .turn(turn)
                    .originalResponse(original)
                    .replayedResponse(replayed)
                    .diff(diff)
                    .build());
            }
            
            return ReplayResult.builder()
                .conversationId(conversationId)
                .steps(steps)
                .consistency(calculateConsistency(steps))
                .build();
        }
    }
    
    // ì„±ëŠ¥ í”„ë¡œíŒŒì¼ëŸ¬
    @Component
    public class AIPerformanceProfiler {
        
        @Around("@annotation(Profiled)")
        public Object profile(ProceedingJoinPoint pjp) throws Throwable {
            String operation = pjp.getSignature().getName();
            
            ProfileContext context = ProfileContext.start(operation);
            
            try {
                // ë©”ëª¨ë¦¬ ìŠ¤ëƒ…ìƒ·
                context.captureMemoryBefore();
                
                // ì‹¤í–‰
                Object result = pjp.proceed();
                
                // ë©”íŠ¸ë¦­ ìˆ˜ì§‘
                context.captureMemoryAfter();
                context.recordDuration();
                
                if (result instanceof ChatResponse) {
                    context.recordTokens(((ChatResponse) result).getTokensUsed());
                }
                
                // ë¶„ì„
                if (context.getDuration() > slowThreshold) {
                    analyzeSlowOperation(context);
                }
                
                return result;
                
            } finally {
                profileRepository.save(context.toProfile());
            }
        }
        
        private void analyzeSlowOperation(ProfileContext context) {
            SlowOperationAnalysis analysis = SlowOperationAnalysis.builder()
                .operation(context.getOperation())
                .duration(context.getDuration())
                .memoryDelta(context.getMemoryDelta())
                .possibleCauses(identifyBottlenecks(context))
                .recommendations(generateRecommendations(context))
                .build();
            
            log.warn("Slow operation detected: {}", analysis);
            alertManager.sendSlowOperationAlert(analysis);
        }
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Best Practices -->
            <section class="mb-12">
                <h2 class="text-2xl font-semibold mb-4">ğŸ¯ ëª¨ë‹ˆí„°ë§ Best Practices</h2>
                
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="font-semibold mb-3">í•„ìˆ˜ ëª¨ë‹ˆí„°ë§ í•­ëª©</h3>
                            <ul class="space-y-1 text-sm">
                                <li>âœ… ì‘ë‹µ ì‹œê°„ (P50, P95, P99)</li>
                                <li>âœ… í† í° ì‚¬ìš©ëŸ‰ ë° ë¹„ìš©</li>
                                <li>âœ… ì˜¤ë¥˜ìœ¨ ë° ì¬ì‹œë„ìœ¨</li>
                                <li>âœ… ëª¨ë¸ë³„ ì„±ëŠ¥ ë¹„êµ</li>
                                <li>âœ… ì‚¬ìš©ìë³„ ì‚¬ìš© íŒ¨í„´</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold mb-3">ì•Œë¦¼ ì „ëµ</h3>
                            <ul class="space-y-1 text-sm">
                                <li>ğŸš¨ Critical: ì„œë¹„ìŠ¤ ì¤‘ë‹¨, ì˜ˆì‚° ì´ˆê³¼</li>
                                <li>âš ï¸ Warning: ì„±ëŠ¥ ì €í•˜, ë†’ì€ ì˜¤ë¥˜ìœ¨</li>
                                <li>â„¹ï¸ Info: ì¼ì¼ ë¦¬í¬íŠ¸, íŠ¸ë Œë“œ ë³€í™”</li>
                                <li>ğŸ” Debug: ê°œë°œ í™˜ê²½ ìƒì„¸ ë¡œê·¸</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="font-semibold mb-3">ë¹„ìš© ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                        <div class="bg-white p-4 rounded-lg">
                            <ul class="space-y-1 text-sm">
                                <li>â–¡ í”„ë¡¬í”„íŠ¸ ê¸¸ì´ ìµœì í™”</li>
                                <li>â–¡ ì ì ˆí•œ ëª¨ë¸ ì„ íƒ</li>
                                <li>â–¡ ì‘ë‹µ ìºì‹± êµ¬í˜„</li>
                                <li>â–¡ ë°°ì¹˜ ì²˜ë¦¬ í™œìš©</li>
                                <li>â–¡ ì‚¬ìš©ëŸ‰ ì œí•œ ì„¤ì •</li>
                                <li>â–¡ ì •ê¸°ì ì¸ ë¹„ìš© ë¦¬ë·°</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Next Steps -->
            <section class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-xl font-semibold mb-4">ë‹¤ìŒ ë‹¨ê³„</h2>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <a href="patterns.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-blue-600 mb-2">AI íŒ¨í„´</h3>
                        <p class="text-sm text-gray-600">íš¨ê³¼ì ì¸ AI ì• í”Œë¦¬ì¼€ì´ì…˜ íŒ¨í„´</p>
                    </a>
                    
                    <a href="performance.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-green-600 mb-2">ì„±ëŠ¥ ìµœì í™”</h3>
                        <p class="text-sm text-gray-600">AI ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ê°œì„ </p>
                    </a>
                    
                    <a href="troubleshooting.html" class="block p-4 border rounded-lg hover:bg-gray-50 transition">
                        <h3 class="font-semibold text-purple-600 mb-2">ë¬¸ì œ í•´ê²°</h3>
                        <p class="text-sm text-gray-600">ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²° ë°©ë²•</p>
                    </a>
                </div>
            </section>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        function copyCode(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }
    </script>
</body>
</html>